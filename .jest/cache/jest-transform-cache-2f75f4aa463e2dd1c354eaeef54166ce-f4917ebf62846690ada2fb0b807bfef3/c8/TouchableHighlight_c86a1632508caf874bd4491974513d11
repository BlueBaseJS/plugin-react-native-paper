4e08b30ae8e5faa2a8cc24928939a85d
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var ColorPropType = require('ColorPropType');

var NativeMethodsMixin = require('NativeMethodsMixin');

var PropTypes = require('prop-types');

var Platform = require('Platform');

var React = require('React');

var ReactNativeViewAttributes = require('ReactNativeViewAttributes');

var StyleSheet = require('StyleSheet');

var Touchable = require('Touchable');

var TouchableWithoutFeedback = require('TouchableWithoutFeedback');

var View = require('View');

var ViewPropTypes = require('ViewPropTypes');

var createReactClass = require('create-react-class');

var ensurePositiveDelayProps = require('ensurePositiveDelayProps');

var DEFAULT_PROPS = {
  activeOpacity: 0.85,
  delayPressOut: 100,
  underlayColor: 'black'
};
var PRESS_RETENTION_OFFSET = {
  top: 20,
  left: 20,
  right: 20,
  bottom: 30
};
var TouchableHighlight = createReactClass({
  displayName: 'TouchableHighlight',
  propTypes: (0, _objectSpread2.default)({}, TouchableWithoutFeedback.propTypes, {
    activeOpacity: PropTypes.number,
    underlayColor: ColorPropType,
    style: ViewPropTypes.style,
    onShowUnderlay: PropTypes.func,
    onHideUnderlay: PropTypes.func,
    hasTVPreferredFocus: PropTypes.bool,
    tvParallaxProperties: PropTypes.object,
    testOnly_pressed: PropTypes.bool
  }),
  mixins: [NativeMethodsMixin, Touchable.Mixin],
  getDefaultProps: function getDefaultProps() {
    return DEFAULT_PROPS;
  },
  getInitialState: function getInitialState() {
    this._isMounted = false;

    if (this.props.testOnly_pressed) {
      return (0, _objectSpread2.default)({}, this.touchableGetInitialState(), {
        extraChildStyle: {
          opacity: this.props.activeOpacity
        },
        extraUnderlayStyle: {
          backgroundColor: this.props.underlayColor
        }
      });
    } else {
      return (0, _objectSpread2.default)({}, this.touchableGetInitialState(), {
        extraChildStyle: null,
        extraUnderlayStyle: null
      });
    }
  },
  componentDidMount: function componentDidMount() {
    this._isMounted = true;
    ensurePositiveDelayProps(this.props);
  },
  componentWillUnmount: function componentWillUnmount() {
    this._isMounted = false;
    clearTimeout(this._hideTimeout);
  },
  UNSAFE_componentWillReceiveProps: function UNSAFE_componentWillReceiveProps(nextProps) {
    ensurePositiveDelayProps(nextProps);
  },
  viewConfig: {
    uiViewClassName: 'RCTView',
    validAttributes: ReactNativeViewAttributes.RCTView
  },
  touchableHandleActivePressIn: function touchableHandleActivePressIn(e) {
    clearTimeout(this._hideTimeout);
    this._hideTimeout = null;

    this._showUnderlay();

    this.props.onPressIn && this.props.onPressIn(e);
  },
  touchableHandleActivePressOut: function touchableHandleActivePressOut(e) {
    if (!this._hideTimeout) {
      this._hideUnderlay();
    }

    this.props.onPressOut && this.props.onPressOut(e);
  },
  touchableHandlePress: function touchableHandlePress(e) {
    clearTimeout(this._hideTimeout);

    if (!Platform.isTV) {
      this._showUnderlay();

      this._hideTimeout = setTimeout(this._hideUnderlay, this.props.delayPressOut);
    }

    this.props.onPress && this.props.onPress(e);
  },
  touchableHandleLongPress: function touchableHandleLongPress(e) {
    this.props.onLongPress && this.props.onLongPress(e);
  },
  touchableGetPressRectOffset: function touchableGetPressRectOffset() {
    return this.props.pressRetentionOffset || PRESS_RETENTION_OFFSET;
  },
  touchableGetHitSlop: function touchableGetHitSlop() {
    return this.props.hitSlop;
  },
  touchableGetHighlightDelayMS: function touchableGetHighlightDelayMS() {
    return this.props.delayPressIn;
  },
  touchableGetLongPressDelayMS: function touchableGetLongPressDelayMS() {
    return this.props.delayLongPress;
  },
  touchableGetPressOutDelayMS: function touchableGetPressOutDelayMS() {
    return this.props.delayPressOut;
  },
  _showUnderlay: function _showUnderlay() {
    if (!this._isMounted || !this._hasPressHandler()) {
      return;
    }

    this.setState({
      extraChildStyle: {
        opacity: this.props.activeOpacity
      },
      extraUnderlayStyle: {
        backgroundColor: this.props.underlayColor
      }
    });
    this.props.onShowUnderlay && this.props.onShowUnderlay();
  },
  _hideUnderlay: function _hideUnderlay() {
    clearTimeout(this._hideTimeout);
    this._hideTimeout = null;

    if (this.props.testOnly_pressed) {
      return;
    }

    if (this._hasPressHandler()) {
      this.setState({
        extraChildStyle: null,
        extraUnderlayStyle: null
      });
      this.props.onHideUnderlay && this.props.onHideUnderlay();
    }
  },
  _hasPressHandler: function _hasPressHandler() {
    return !!(this.props.onPress || this.props.onPressIn || this.props.onPressOut || this.props.onLongPress);
  },
  render: function render() {
    var child = React.Children.only(this.props.children);
    return React.createElement(View, {
      accessible: this.props.accessible !== false,
      accessibilityLabel: this.props.accessibilityLabel,
      accessibilityHint: this.props.accessibilityHint,
      accessibilityRole: this.props.accessibilityRole,
      accessibilityStates: this.props.accessibilityStates,
      style: StyleSheet.compose(this.props.style, this.state.extraUnderlayStyle),
      onLayout: this.props.onLayout,
      hitSlop: this.props.hitSlop,
      isTVSelectable: true,
      tvParallaxProperties: this.props.tvParallaxProperties,
      hasTVPreferredFocus: this.props.hasTVPreferredFocus,
      onStartShouldSetResponder: this.touchableHandleStartShouldSetResponder,
      onResponderTerminationRequest: this.touchableHandleResponderTerminationRequest,
      onResponderGrant: this.touchableHandleResponderGrant,
      onResponderMove: this.touchableHandleResponderMove,
      onResponderRelease: this.touchableHandleResponderRelease,
      onResponderTerminate: this.touchableHandleResponderTerminate,
      nativeID: this.props.nativeID,
      testID: this.props.testID
    }, React.cloneElement(child, {
      style: StyleSheet.compose(child.props.style, this.state.extraChildStyle)
    }), Touchable.renderDebugView({
      color: 'green',
      hitSlop: this.props.hitSlop
    }));
  }
});
module.exports = TouchableHighlight;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRvdWNoYWJsZUhpZ2hsaWdodC5qcyJdLCJuYW1lcyI6WyJDb2xvclByb3BUeXBlIiwicmVxdWlyZSIsIk5hdGl2ZU1ldGhvZHNNaXhpbiIsIlByb3BUeXBlcyIsIlBsYXRmb3JtIiwiUmVhY3QiLCJSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzIiwiU3R5bGVTaGVldCIsIlRvdWNoYWJsZSIsIlRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayIsIlZpZXciLCJWaWV3UHJvcFR5cGVzIiwiY3JlYXRlUmVhY3RDbGFzcyIsImVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyIsIkRFRkFVTFRfUFJPUFMiLCJhY3RpdmVPcGFjaXR5IiwiZGVsYXlQcmVzc091dCIsInVuZGVybGF5Q29sb3IiLCJQUkVTU19SRVRFTlRJT05fT0ZGU0VUIiwidG9wIiwibGVmdCIsInJpZ2h0IiwiYm90dG9tIiwiVG91Y2hhYmxlSGlnaGxpZ2h0IiwiZGlzcGxheU5hbWUiLCJwcm9wVHlwZXMiLCJudW1iZXIiLCJzdHlsZSIsIm9uU2hvd1VuZGVybGF5IiwiZnVuYyIsIm9uSGlkZVVuZGVybGF5IiwiaGFzVFZQcmVmZXJyZWRGb2N1cyIsImJvb2wiLCJ0dlBhcmFsbGF4UHJvcGVydGllcyIsIm9iamVjdCIsInRlc3RPbmx5X3ByZXNzZWQiLCJtaXhpbnMiLCJNaXhpbiIsImdldERlZmF1bHRQcm9wcyIsImdldEluaXRpYWxTdGF0ZSIsIl9pc01vdW50ZWQiLCJwcm9wcyIsInRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSIsImV4dHJhQ2hpbGRTdHlsZSIsIm9wYWNpdHkiLCJleHRyYVVuZGVybGF5U3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb21wb25lbnREaWRNb3VudCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiY2xlYXJUaW1lb3V0IiwiX2hpZGVUaW1lb3V0IiwiVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLCJuZXh0UHJvcHMiLCJ2aWV3Q29uZmlnIiwidWlWaWV3Q2xhc3NOYW1lIiwidmFsaWRBdHRyaWJ1dGVzIiwiUkNUVmlldyIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzSW4iLCJlIiwiX3Nob3dVbmRlcmxheSIsIm9uUHJlc3NJbiIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0IiwiX2hpZGVVbmRlcmxheSIsIm9uUHJlc3NPdXQiLCJ0b3VjaGFibGVIYW5kbGVQcmVzcyIsImlzVFYiLCJzZXRUaW1lb3V0Iiwib25QcmVzcyIsInRvdWNoYWJsZUhhbmRsZUxvbmdQcmVzcyIsIm9uTG9uZ1ByZXNzIiwidG91Y2hhYmxlR2V0UHJlc3NSZWN0T2Zmc2V0IiwicHJlc3NSZXRlbnRpb25PZmZzZXQiLCJ0b3VjaGFibGVHZXRIaXRTbG9wIiwiaGl0U2xvcCIsInRvdWNoYWJsZUdldEhpZ2hsaWdodERlbGF5TVMiLCJkZWxheVByZXNzSW4iLCJ0b3VjaGFibGVHZXRMb25nUHJlc3NEZWxheU1TIiwiZGVsYXlMb25nUHJlc3MiLCJ0b3VjaGFibGVHZXRQcmVzc091dERlbGF5TVMiLCJfaGFzUHJlc3NIYW5kbGVyIiwic2V0U3RhdGUiLCJyZW5kZXIiLCJjaGlsZCIsIkNoaWxkcmVuIiwib25seSIsImNoaWxkcmVuIiwiYWNjZXNzaWJsZSIsImFjY2Vzc2liaWxpdHlMYWJlbCIsImFjY2Vzc2liaWxpdHlIaW50IiwiYWNjZXNzaWJpbGl0eVJvbGUiLCJhY2Nlc3NpYmlsaXR5U3RhdGVzIiwiY29tcG9zZSIsInN0YXRlIiwib25MYXlvdXQiLCJ0b3VjaGFibGVIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlciIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50IiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyTW92ZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2UiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGUiLCJuYXRpdmVJRCIsInRlc3RJRCIsImNsb25lRWxlbWVudCIsInJlbmRlckRlYnVnVmlldyIsImNvbG9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBU0E7Ozs7OztBQUVBLElBQU1BLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGVBQUQsQ0FBN0I7O0FBQ0EsSUFBTUMsa0JBQWtCLEdBQUdELE9BQU8sQ0FBQyxvQkFBRCxDQUFsQzs7QUFDQSxJQUFNRSxTQUFTLEdBQUdGLE9BQU8sQ0FBQyxZQUFELENBQXpCOztBQUNBLElBQU1HLFFBQVEsR0FBR0gsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBQ0EsSUFBTUksS0FBSyxHQUFHSixPQUFPLENBQUMsT0FBRCxDQUFyQjs7QUFDQSxJQUFNSyx5QkFBeUIsR0FBR0wsT0FBTyxDQUFDLDJCQUFELENBQXpDOztBQUNBLElBQU1NLFVBQVUsR0FBR04sT0FBTyxDQUFDLFlBQUQsQ0FBMUI7O0FBQ0EsSUFBTU8sU0FBUyxHQUFHUCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFDQSxJQUFNUSx3QkFBd0IsR0FBR1IsT0FBTyxDQUFDLDBCQUFELENBQXhDOztBQUNBLElBQU1TLElBQUksR0FBR1QsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsSUFBTVUsYUFBYSxHQUFHVixPQUFPLENBQUMsZUFBRCxDQUE3Qjs7QUFFQSxJQUFNVyxnQkFBZ0IsR0FBR1gsT0FBTyxDQUFDLG9CQUFELENBQWhDOztBQUNBLElBQU1ZLHdCQUF3QixHQUFHWixPQUFPLENBQUMsMEJBQUQsQ0FBeEM7O0FBT0EsSUFBTWEsYUFBYSxHQUFHO0FBQ3BCQyxFQUFBQSxhQUFhLEVBQUUsSUFESztBQUVwQkMsRUFBQUEsYUFBYSxFQUFFLEdBRks7QUFHcEJDLEVBQUFBLGFBQWEsRUFBRTtBQUhLLENBQXRCO0FBTUEsSUFBTUMsc0JBQXNCLEdBQUc7QUFBQ0MsRUFBQUEsR0FBRyxFQUFFLEVBQU47QUFBVUMsRUFBQUEsSUFBSSxFQUFFLEVBQWhCO0FBQW9CQyxFQUFBQSxLQUFLLEVBQUUsRUFBM0I7QUFBK0JDLEVB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S0MsaUNBdEI3QjtBQXVCRSxNQUFBLFFBQVEsRUFBRSxLQUFLMUQsS0FBTCxDQUFXMkQsUUF2QnZCO0FBd0JFLE1BQUEsTUFBTSxFQUFFLEtBQUszRCxLQUFMLENBQVc0RDtBQXhCckIsT0F5QkdoRyxLQUFLLENBQUNpRyxZQUFOLENBQW1CcEIsS0FBbkIsRUFBMEI7QUFDekJ2RCxNQUFBQSxLQUFLLEVBQUVwQixVQUFVLENBQUNvRixPQUFYLENBQ0xULEtBQUssQ0FBQ3pDLEtBQU4sQ0FBWWQsS0FEUCxFQUVMLEtBQUtpRSxLQUFMLENBQVdqRCxlQUZOO0FBRGtCLEtBQTFCLENBekJILEVBK0JHbkMsU0FBUyxDQUFDK0YsZUFBVixDQUEwQjtBQUN6QkMsTUFBQUEsS0FBSyxFQUFFLE9BRGtCO0FBRXpCL0IsTUFBQUEsT0FBTyxFQUFFLEtBQUtoQyxLQUFMLENBQVdnQztBQUZLLEtBQTFCLENBL0JILENBREY7QUFzQ0Q7QUF2TzJDLENBQUQsQ0FBN0M7QUEwT0FnQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJuRixrQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgQ29sb3JQcm9wVHlwZSA9IHJlcXVpcmUoJ0NvbG9yUHJvcFR5cGUnKTtcbmNvbnN0IE5hdGl2ZU1ldGhvZHNNaXhpbiA9IHJlcXVpcmUoJ05hdGl2ZU1ldGhvZHNNaXhpbicpO1xuY29uc3QgUHJvcFR5cGVzID0gcmVxdWlyZSgncHJvcC10eXBlcycpO1xuY29uc3QgUGxhdGZvcm0gPSByZXF1aXJlKCdQbGF0Zm9ybScpO1xuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdSZWFjdCcpO1xuY29uc3QgUmVhY3ROYXRpdmVWaWV3QXR0cmlidXRlcyA9IHJlcXVpcmUoJ1JlYWN0TmF0aXZlVmlld0F0dHJpYnV0ZXMnKTtcbmNvbnN0IFN0eWxlU2hlZXQgPSByZXF1aXJlKCdTdHlsZVNoZWV0Jyk7XG5jb25zdCBUb3VjaGFibGUgPSByZXF1aXJlKCdUb3VjaGFibGUnKTtcbmNvbnN0IFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayA9IHJlcXVpcmUoJ1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjaycpO1xuY29uc3QgVmlldyA9IHJlcXVpcmUoJ1ZpZXcnKTtcbmNvbnN0IFZpZXdQcm9wVHlwZXMgPSByZXF1aXJlKCdWaWV3UHJvcFR5cGVzJyk7XG5cbmNvbnN0IGNyZWF0ZVJlYWN0Q2xhc3MgPSByZXF1aXJlKCdjcmVhdGUtcmVhY3QtY2xhc3MnKTtcbmNvbnN0IGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyA9IHJlcXVpcmUoJ2Vuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcycpO1xuXG5pbXBvcnQgdHlwZSB7UHJlc3NFdmVudH0gZnJvbSAnQ29yZUV2ZW50VHlwZXMnO1xuaW1wb3J0IHR5cGUge1Byb3BzIGFzIFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFja1Byb3BzfSBmcm9tICdUb3VjaGFibGVXaXRob3V0RmVlZGJhY2snO1xuaW1wb3J0IHR5cGUge1ZpZXdTdHlsZVByb3B9IGZyb20gJ1N0eWxlU2hlZXQnO1xuaW1wb3J0IHR5cGUge0NvbG9yVmFsdWV9IGZyb20gJ1N0eWxlU2hlZXRUeXBlcyc7XG5cbmNvbnN0IERFRkFVTFRfUFJPUFMgPSB7XG4gIGFjdGl2ZU9wYWNpdHk6IDAuODUsXG4gIGRlbGF5UHJlc3NPdXQ6IDEwMCxcbiAgdW5kZXJsYXlDb2xvcjogJ2JsYWNrJyxcbn07XG5cbmNvbnN0IFBSRVNTX1JFVEVOVElPTl9PRkZTRVQgPSB7dG9wOiAyMCwgbGVmdDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMH07XG5cbnR5cGUgSU9TUHJvcHMgPSAkUmVhZE9ubHk8e3xcbiAgaGFzVFZQcmVmZXJyZWRGb2N1cz86ID9ib29sZWFuLFxuICB0dlBhcmFsbGF4UHJvcGVydGllcz86ID9PYmplY3QsXG58fT47XG5cbnR5cGUgUHJvcHMgPSAkUmVhZE9ubHk8e3xcbiAgLi4uVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrUHJvcHMsXG4gIC4uLklPU1Byb3BzLFxuXG4gIGFjdGl2ZU9wYWNpdHk/OiA/bnVtYmVyLFxuICB1bmRlcmxheUNvbG9yPzogP0NvbG9yVmFsdWUsXG4gIHN0eWxlPzogP1ZpZXdTdHlsZVByb3AsXG4gIG9uU2hvd1VuZGVybGF5PzogP0Z1bmN0aW9uLFxuICBvbkhpZGVVbmRlcmxheT86ID9GdW5jdGlvbixcbiAgdGVzdE9ubHlfcHJlc3NlZD86ID9ib29sZWFuLFxufH0+O1xuXG4vKipcbiAqIEEgd3JhcHBlciBmb3IgbWFraW5nIHZpZXdzIHJlc3BvbmQgcHJvcGVybHkgdG8gdG91Y2hlcy5cbiAqIE9uIHByZXNzIGRvd24sIHRoZSBvcGFjaXR5IG9mIHRoZSB3cmFwcGVkIHZpZXcgaXMgZGVjcmVhc2VkLCB3aGljaCBhbGxvd3NcbiAqIHRoZSB1bmRlcmxheSBjb2xvciB0byBzaG93IHRocm91Z2gsIGRhcmtlbmluZyBvciB0aW50aW5nIHRoZSB2aWV3LlxuICpcbiAqIFRoZSB1bmRlcmxheSBjb21lcyBmcm9tIHdyYXBwaW5nIHRoZSBjaGlsZCBpbiBhIG5ldyBWaWV3LCB3aGljaCBjYW4gYWZmZWN0XG4gKiBsYXlvdXQsIGFuZCBzb21ldGltZXMgY2F1c2UgdW53YW50ZWQgdmlzdWFsIGFydGlmYWN0cyBpZiBub3QgdXNlZCBjb3JyZWN0bHksXG4gKiBmb3IgZXhhbXBsZSBpZiB0aGUgYmFja2dyb3VuZENvbG9yIG9mIHRoZSB3cmFwcGVkIHZpZXcgaXNuJ3QgZXhwbGljaXRseSBzZXRcbiAqIHRvIGFuIG9wYXF1ZSBjb2xvci5cbiAqXG4gKiBUb3VjaGFibGVIaWdobGlnaHQgbXVzdCBoYXZlIG9uZSBjaGlsZCAobm90IHplcm8gb3IgbW9yZSB0aGFuIG9uZSkuXG4gKiBJZiB5b3Ugd2lzaCB0byBoYXZlIHNldmVyYWwgY2hpbGQgY29tcG9uZW50cywgd3JhcCB0aGVtIGluIGEgVmlldy5cbiAqXG4gKiBFeGFtcGxlOlxuICpcbiAqIGBgYFxuICogcmVuZGVyQnV0dG9uOiBmdW5jdGlvbigpIHtcbiAqICAgcmV0dXJuIChcbiAqICAgICA8VG91Y2hhYmxlSGlnaGxpZ2h0IG9uUHJlc3M9e3RoaXMuX29uUHJlc3NCdXR0b259PlxuICogICAgICAgPEltYWdlXG4gKiAgICAgICAgIHN0eWxlPXtzdHlsZXMuYnV0dG9ufVxuICogICAgICAgICBzb3VyY2U9e3JlcXVpcmUoJy4vbXlCdXR0b24ucG5nJyl9XG4gKiAgICAgICAvPlxuICogICAgIDwvVG91Y2hhYmxlSGlnaGxpZ2h0PlxuICogICApO1xuICogfSxcbiAqIGBgYFxuICpcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICpcbiAqIGBgYFJlYWN0TmF0aXZlV2ViUGxheWVyXG4gKiBpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnXG4gKiBpbXBvcnQge1xuICogICBBcHBSZWdpc3RyeSxcbiAqICAgU3R5bGVTaGVldCxcbiAqICAgVG91Y2hhYmxlSGlnaGxpZ2h0LFxuICogICBUZXh0LFxuICogICBWaWV3LFxuICogfSBmcm9tICdyZWFjdC1uYXRpdmUnXG4gKlxuICogY2xhc3MgQXBwIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAqICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAqICAgICBzdXBlcihwcm9wcylcbiAqICAgICB0aGlzLnN0YXRlID0geyBjb3VudDogMCB9XG4gKiAgIH1cbiAqXG4gKiAgIG9uUHJlc3MgPSAoKSA9PiB7XG4gKiAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gKiAgICAgICBjb3VudDogdGhpcy5zdGF0ZS5jb3VudCsxXG4gKiAgICAgfSlcbiAqICAgfVxuICpcbiAqICByZW5kZXIoKSB7XG4gKiAgICAgcmV0dXJuIChcbiAqICAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT5cbiAqICAgICAgICAgPFRvdWNoYWJsZUhpZ2hsaWdodFxuICogICAgICAgICAgc3R5bGU9e3N0eWxlcy5idXR0b259XG4gKiAgICAgICAgICBvblByZXNzPXt0aGlzLm9uUHJlc3N9XG4gKiAgICAgICAgID5cbiAqICAgICAgICAgIDxUZXh0PiBUb3VjaCBIZXJlIDwvVGV4dD5cbiAqICAgICAgICAgPC9Ub3VjaGFibGVIaWdobGlnaHQ+XG4gKiAgICAgICAgIDxWaWV3IHN0eWxlPXtbc3R5bGVzLmNvdW50Q29udGFpbmVyXX0+XG4gKiAgICAgICAgICAgPFRleHQgc3R5bGU9e1tzdHlsZXMuY291bnRUZXh0XX0+XG4gKiAgICAgICAgICAgICB7IHRoaXMuc3RhdGUuY291bnQgIT09IDAgPyB0aGlzLnN0YXRlLmNvdW50OiBudWxsfVxuICogICAgICAgICAgIDwvVGV4dD5cbiAqICAgICAgICAgPC9WaWV3PlxuICogICAgICAgPC9WaWV3PlxuICogICAgIClcbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAqICAgY29udGFpbmVyOiB7XG4gKiAgICAgZmxleDogMSxcbiAqICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZ0hvcml6b250YWw6IDEwXG4gKiAgIH0sXG4gKiAgIGJ1dHRvbjoge1xuICogICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICogICAgIGJhY2tncm91bmRDb2xvcjogJyNEREREREQnLFxuICogICAgIHBhZGRpbmc6IDEwXG4gKiAgIH0sXG4gKiAgIGNvdW50Q29udGFpbmVyOiB7XG4gKiAgICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZzogMTBcbiAqICAgfSxcbiAqICAgY291bnRUZXh0OiB7XG4gKiAgICAgY29sb3I6ICcjRkYwMEZGJ1xuICogICB9XG4gKiB9KVxuICpcbiAqIEFwcFJlZ2lzdHJ5LnJlZ2lzdGVyQ29tcG9uZW50KCdBcHAnLCAoKSA9PiBBcHApXG4gKiBgYGBcbiAqXG4gKi9cblxuY29uc3QgVG91Y2hhYmxlSGlnaGxpZ2h0ID0gKChjcmVhdGVSZWFjdENsYXNzKHtcbiAgZGlzcGxheU5hbWU6ICdUb3VjaGFibGVIaWdobGlnaHQnLFxuICBwcm9wVHlwZXM6IHtcbiAgICAuLi5Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2sucHJvcFR5cGVzLFxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgd2hhdCB0aGUgb3BhY2l0eSBvZiB0aGUgd3JhcHBlZCB2aWV3IHNob3VsZCBiZSB3aGVuIHRvdWNoIGlzXG4gICAgICogYWN0aXZlLlxuICAgICAqL1xuICAgIGFjdGl2ZU9wYWNpdHk6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgLyoqXG4gICAgICogVGhlIGNvbG9yIG9mIHRoZSB1bmRlcmxheSB0aGF0IHdpbGwgc2hvdyB0aHJvdWdoIHdoZW4gdGhlIHRvdWNoIGlzXG4gICAgICogYWN0aXZlLlxuICAgICAqL1xuICAgIHVuZGVybGF5Q29sb3I6IENvbG9yUHJvcFR5cGUsXG4gICAgLyoqXG4gICAgICogU3R5bGUgdG8gYXBwbHkgdG8gdGhlIGNvbnRhaW5lci91bmRlcmxheS4gTW9zdCBjb21tb25seSB1c2VkIHRvIG1ha2Ugc3VyZVxuICAgICAqIHJvdW5kZWQgY29ybmVycyBtYXRjaCB0aGUgd3JhcHBlZCBjb21wb25lbnQuXG4gICAgICovXG4gICAgc3R5bGU6IFZpZXdQcm9wVHlwZXMuc3R5bGUsXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSB1bmRlcmxheSBpcyBzaG93blxuICAgICAqL1xuICAgIG9uU2hvd1VuZGVybGF5OiBQcm9wVHlwZXMuZnVuYyxcbiAgICAvKipcbiAgICAgKiBDYWxsZWQgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIHVuZGVybGF5IGlzIGhpZGRlblxuICAgICAqL1xuICAgIG9uSGlkZVVuZGVybGF5OiBQcm9wVHlwZXMuZnVuYyxcbiAgICAvKipcbiAgICAgKiAqKEFwcGxlIFRWIG9ubHkpKiBUViBwcmVmZXJyZWQgZm9jdXMgKHNlZSBkb2N1bWVudGF0aW9uIGZvciB0aGUgVmlldyBjb21wb25lbnQpLlxuICAgICAqXG4gICAgICogQHBsYXRmb3JtIGlvc1xuICAgICAqL1xuICAgIGhhc1RWUHJlZmVycmVkRm9jdXM6IFByb3BUeXBlcy5ib29sLFxuICAgIC8qKlxuICAgICAqICooQXBwbGUgVFYgb25seSkqIE9iamVjdCB3aXRoIHByb3BlcnRpZXMgdG8gY29udHJvbCBBcHBsZSBUViBwYXJhbGxheCBlZmZlY3RzLlxuICAgICAqXG4gICAgICogZW5hYmxlZDogSWYgdHJ1ZSwgcGFyYWxsYXggZWZmZWN0cyBhcmUgZW5hYmxlZC4gIERlZmF1bHRzIHRvIHRydWUuXG4gICAgICogc2hpZnREaXN0YW5jZVg6IERlZmF1bHRzIHRvIDIuMC5cbiAgICAgKiBzaGlmdERpc3RhbmNlWTogRGVmYXVsdHMgdG8gMi4wLlxuICAgICAqIHRpbHRBbmdsZTogRGVmYXVsdHMgdG8gMC4wNS5cbiAgICAgKiBtYWduaWZpY2F0aW9uOiBEZWZhdWx0cyB0byAxLjAuXG4gICAgICogcHJlc3NNYWduaWZpY2F0aW9uOiBEZWZhdWx0cyB0byAxLjAuXG4gICAgICogcHJlc3NEdXJhdGlvbjogRGVmYXVsdHMgdG8gMC4zLlxuICAgICAqIHByZXNzRGVsYXk6IERlZmF1bHRzIHRvIDAuMC5cbiAgICAgKlxuICAgICAqIEBwbGF0Zm9ybSBpb3NcbiAgICAgKi9cbiAgICB0dlBhcmFsbGF4UHJvcGVydGllczogUHJvcFR5cGVzLm9iamVjdCxcbiAgICAvKipcbiAgICAgKiBIYW5keSBmb3Igc25hcHNob3QgdGVzdHMuXG4gICAgICovXG4gICAgdGVzdE9ubHlfcHJlc3NlZDogUHJvcFR5cGVzLmJvb2wsXG4gIH0sXG5cbiAgbWl4aW5zOiBbTmF0aXZlTWV0aG9kc01peGluLCBUb3VjaGFibGUuTWl4aW5dLFxuXG4gIGdldERlZmF1bHRQcm9wczogKCkgPT4gREVGQVVMVF9QUk9QUyxcblxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX2lzTW91bnRlZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnByb3BzLnRlc3RPbmx5X3ByZXNzZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnRoaXMudG91Y2hhYmxlR2V0SW5pdGlhbFN0YXRlKCksXG4gICAgICAgIGV4dHJhQ2hpbGRTdHlsZToge1xuICAgICAgICAgIG9wYWNpdHk6IHRoaXMucHJvcHMuYWN0aXZlT3BhY2l0eSxcbiAgICAgICAgfSxcbiAgICAgICAgZXh0cmFVbmRlcmxheVN0eWxlOiB7XG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLnVuZGVybGF5Q29sb3IsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi50aGlzLnRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSgpLFxuICAgICAgICBleHRyYUNoaWxkU3R5bGU6IG51bGwsXG4gICAgICAgIGV4dHJhVW5kZXJsYXlTdHlsZTogbnVsbCxcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9pc01vdW50ZWQgPSB0cnVlO1xuICAgIGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyh0aGlzLnByb3BzKTtcbiAgfSxcblxuICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5faXNNb3VudGVkID0gZmFsc2U7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuX2hpZGVUaW1lb3V0KTtcbiAgfSxcblxuICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24obmV4dFByb3BzKSB7XG4gICAgZW5zdXJlUG9zaXRpdmVEZWxheVByb3BzKG5leHRQcm9wcyk7XG4gIH0sXG5cbiAgdmlld0NvbmZpZzoge1xuICAgIHVpVmlld0NsYXNzTmFtZTogJ1JDVFZpZXcnLFxuICAgIHZhbGlkQXR0cmlidXRlczogUmVhY3ROYXRpdmVWaWV3QXR0cmlidXRlcy5SQ1RWaWV3LFxuICB9LFxuXG4gIC8qKlxuICAgKiBgVG91Y2hhYmxlLk1peGluYCBzZWxmIGNhbGxiYWNrcy4gVGhlIG1peGluIHdpbGwgaW52b2tlIHRoZXNlIGlmIHRoZXkgYXJlXG4gICAqIGRlZmluZWQgb24geW91ciBjb21wb25lbnQuXG4gICAqL1xuICB0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luOiBmdW5jdGlvbihlOiBQcmVzc0V2ZW50KSB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuX2hpZGVUaW1lb3V0KTtcbiAgICB0aGlzLl9oaWRlVGltZW91dCA9IG51bGw7XG4gICAgdGhpcy5fc2hvd1VuZGVybGF5KCk7XG4gICAgdGhpcy5wcm9wcy5vblByZXNzSW4gJiYgdGhpcy5wcm9wcy5vblByZXNzSW4oZSk7XG4gIH0sXG5cbiAgdG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NPdXQ6IGZ1bmN0aW9uKGU6IFByZXNzRXZlbnQpIHtcbiAgICBpZiAoIXRoaXMuX2hpZGVUaW1lb3V0KSB7XG4gICAgICB0aGlzLl9oaWRlVW5kZXJsYXkoKTtcbiAgICB9XG4gICAgdGhpcy5wcm9wcy5vblByZXNzT3V0ICYmIHRoaXMucHJvcHMub25QcmVzc091dChlKTtcbiAgfSxcblxuICB0b3VjaGFibGVIYW5kbGVQcmVzczogZnVuY3Rpb24oZTogUHJlc3NFdmVudCkge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9oaWRlVGltZW91dCk7XG4gICAgaWYgKCFQbGF0Zm9ybS5pc1RWKSB7XG4gICAgICB0aGlzLl9zaG93VW5kZXJsYXkoKTtcbiAgICAgIHRoaXMuX2hpZGVUaW1lb3V0ID0gc2V0VGltZW91dChcbiAgICAgICAgdGhpcy5faGlkZVVuZGVybGF5LFxuICAgICAgICB0aGlzLnByb3BzLmRlbGF5UHJlc3NPdXQsXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLm9uUHJlc3MgJiYgdGhpcy5wcm9wcy5vblByZXNzKGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUhhbmRsZUxvbmdQcmVzczogZnVuY3Rpb24oZTogUHJlc3NFdmVudCkge1xuICAgIHRoaXMucHJvcHMub25Mb25nUHJlc3MgJiYgdGhpcy5wcm9wcy5vbkxvbmdQcmVzcyhlKTtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLnByZXNzUmV0ZW50aW9uT2Zmc2V0IHx8IFBSRVNTX1JFVEVOVElPTl9PRkZTRVQ7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0SGl0U2xvcDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuaGl0U2xvcDtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRIaWdobGlnaHREZWxheU1TOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzSW47XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0TG9uZ1ByZXNzRGVsYXlNUzogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuZGVsYXlMb25nUHJlc3M7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0UHJlc3NPdXREZWxheU1TOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzT3V0O1xuICB9LFxuXG4gIF9zaG93VW5kZXJsYXk6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5faXNNb3VudGVkIHx8ICF0aGlzLl9oYXNQcmVzc0hhbmRsZXIoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGV4dHJhQ2hpbGRTdHlsZToge1xuICAgICAgICBvcGFjaXR5OiB0aGlzLnByb3BzLmFjdGl2ZU9wYWNpdHksXG4gICAgICB9LFxuICAgICAgZXh0cmFVbmRlcmxheVN0eWxlOiB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy51bmRlcmxheUNvbG9yLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICB0aGlzLnByb3BzLm9uU2hvd1VuZGVybGF5ICYmIHRoaXMucHJvcHMub25TaG93VW5kZXJsYXkoKTtcbiAgfSxcblxuICBfaGlkZVVuZGVybGF5OiBmdW5jdGlvbigpIHtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5faGlkZVRpbWVvdXQpO1xuICAgIHRoaXMuX2hpZGVUaW1lb3V0ID0gbnVsbDtcbiAgICBpZiAodGhpcy5wcm9wcy50ZXN0T25seV9wcmVzc2VkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLl9oYXNQcmVzc0hhbmRsZXIoKSkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGV4dHJhQ2hpbGRTdHlsZTogbnVsbCxcbiAgICAgICAgZXh0cmFVbmRlcmxheVN0eWxlOiBudWxsLFxuICAgICAgfSk7XG4gICAgICB0aGlzLnByb3BzLm9uSGlkZVVuZGVybGF5ICYmIHRoaXMucHJvcHMub25IaWRlVW5kZXJsYXkoKTtcbiAgICB9XG4gIH0sXG5cbiAgX2hhc1ByZXNzSGFuZGxlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICEhKFxuICAgICAgdGhpcy5wcm9wcy5vblByZXNzIHx8XG4gICAgICB0aGlzLnByb3BzLm9uUHJlc3NJbiB8fFxuICAgICAgdGhpcy5wcm9wcy5vblByZXNzT3V0IHx8XG4gICAgICB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzXG4gICAgKTtcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGNoaWxkID0gUmVhY3QuQ2hpbGRyZW4ub25seSh0aGlzLnByb3BzLmNoaWxkcmVuKTtcbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXdcbiAgICAgICAgYWNjZXNzaWJsZT17dGhpcy5wcm9wcy5hY2Nlc3NpYmxlICE9PSBmYWxzZX1cbiAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlMYWJlbH1cbiAgICAgICAgYWNjZXNzaWJpbGl0eUhpbnQ9e3RoaXMucHJvcHMuYWNjZXNzaWJpbGl0eUhpbnR9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlSb2xlfVxuICAgICAgICBhY2Nlc3NpYmlsaXR5U3RhdGVzPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlTdGF0ZXN9XG4gICAgICAgIHN0eWxlPXtTdHlsZVNoZWV0LmNvbXBvc2UoXG4gICAgICAgICAgdGhpcy5wcm9wcy5zdHlsZSxcbiAgICAgICAgICB0aGlzLnN0YXRlLmV4dHJhVW5kZXJsYXlTdHlsZSxcbiAgICAgICAgKX1cbiAgICAgICAgb25MYXlvdXQ9e3RoaXMucHJvcHMub25MYXlvdXR9XG4gICAgICAgIGhpdFNsb3A9e3RoaXMucHJvcHMuaGl0U2xvcH1cbiAgICAgICAgaXNUVlNlbGVjdGFibGU9e3RydWV9XG4gICAgICAgIHR2UGFyYWxsYXhQcm9wZXJ0aWVzPXt0aGlzLnByb3BzLnR2UGFyYWxsYXhQcm9wZXJ0aWVzfVxuICAgICAgICBoYXNUVlByZWZlcnJlZEZvY3VzPXt0aGlzLnByb3BzLmhhc1RWUHJlZmVycmVkRm9jdXN9XG4gICAgICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXI9e3RoaXMudG91Y2hhYmxlSGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXJ9XG4gICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0PXtcbiAgICAgICAgICB0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdFxuICAgICAgICB9XG4gICAgICAgIG9uUmVzcG9uZGVyR3JhbnQ9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnR9XG4gICAgICAgIG9uUmVzcG9uZGVyTW92ZT17dGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJNb3ZlfVxuICAgICAgICBvblJlc3BvbmRlclJlbGVhc2U9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyUmVsZWFzZX1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGU9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRlfVxuICAgICAgICBuYXRpdmVJRD17dGhpcy5wcm9wcy5uYXRpdmVJRH1cbiAgICAgICAgdGVzdElEPXt0aGlzLnByb3BzLnRlc3RJRH0+XG4gICAgICAgIHtSZWFjdC5jbG9uZUVsZW1lbnQoY2hpbGQsIHtcbiAgICAgICAgICBzdHlsZTogU3R5bGVTaGVldC5jb21wb3NlKFxuICAgICAgICAgICAgY2hpbGQucHJvcHMuc3R5bGUsXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmV4dHJhQ2hpbGRTdHlsZSxcbiAgICAgICAgICApLFxuICAgICAgICB9KX1cbiAgICAgICAge1RvdWNoYWJsZS5yZW5kZXJEZWJ1Z1ZpZXcoe1xuICAgICAgICAgIGNvbG9yOiAnZ3JlZW4nLFxuICAgICAgICAgIGhpdFNsb3A6IHRoaXMucHJvcHMuaGl0U2xvcCxcbiAgICAgICAgfSl9XG4gICAgICA8L1ZpZXc+XG4gICAgKTtcbiAgfSxcbn0pOiBhbnkpOiBSZWFjdC5Db21wb25lbnRUeXBlPFByb3BzPik7XG5cbm1vZHVsZS5leHBvcnRzID0gVG91Y2hhYmxlSGlnaGxpZ2h0O1xuIl19