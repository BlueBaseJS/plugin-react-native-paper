{"version":3,"sources":["Menu.js"],"names":["SCREEN_INDENT","ANIMATION_DURATION","EASING","Easing","bezier","Menu","top","left","menuLayout","width","height","anchorLayout","opacityAnimation","Animated","Value","scaleAnimation","ValueXY","x","y","Promise","resolve","_menu","measureInWindow","_anchor","props","visible","_show","_hide","BackHandler","addEventListener","onDismiss","all","_measureMenuLayout","_measureAnchorLayout","removeEventListener","setTimeout","setState","parallel","timing","state","toValue","duration","easing","useNativeDriver","start","finished","setValue","prevProps","_updateVisibility","anchor","style","children","theme","additionalVerticalValue","Platform","select","android","default","scaleTransforms","scaleX","interpolate","inputRange","outputRange","scaleY","positionTransforms","Dimensions","get","screenWidth","screenHeight","push","translateX","right","translateY","bottom","shadowMenuContainerStyle","opacity","transform","borderRadius","roundness","positionStyle","I18nManager","isRTL","ref","StyleSheet","absoluteFill","styles","wrapper","shadowMenuContainer","React","Component","MenuItem","create","position","paddingVertical","elevation"],"mappings":"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","sourcesContent":["/* @flow */\n\nimport * as React from 'react';\nimport {\n  StyleSheet,\n  Animated,\n  View,\n  Easing,\n  Dimensions,\n  TouchableWithoutFeedback,\n  I18nManager,\n  BackHandler,\n  Platform,\n} from 'react-native';\nimport { withTheme } from '../../core/theming';\nimport type { Theme } from '../../types';\nimport Portal from '../Portal/Portal';\nimport Surface from '../Surface';\nimport MenuItem from './MenuItem';\n\ntype Props = {\n  /**\n   * Whether the Menu is currently visible.\n   */\n  visible: boolean,\n  /**\n   * The anchor to open the menu from. In most cases, it will be a button that opens the manu.\n   */\n  anchor: React.Node,\n  /**\n   * Callback called when Menu is dismissed. The `visible` prop needs to be updated when this is called.\n   */\n  onDismiss: () => mixed,\n  /**\n   * Content of the `Menu`.\n   */\n  children: React.Node,\n  style?: any,\n  /**\n   * @optional\n   */\n  theme: Theme,\n};\n\ntype State = {\n  top: number,\n  left: number,\n  menuLayout: { height: number, width: number },\n  anchorLayout: { height: number, width: number },\n  opacityAnimation: Animated.Value,\n  scaleAnimation: Animated.ValueXY,\n};\n\n// Minimum padding between the edge of the screen and the menu\nconst SCREEN_INDENT = 8;\n// From https://material.io/design/motion/speed.html#duration\nconst ANIMATION_DURATION = 250;\n// From the 'Standard easing' section of https://material.io/design/motion/speed.html#easing\nconst EASING = Easing.bezier(0.4, 0, 0.2, 1);\n\n/**\n * Menus display a list of choices on temporary elevated surfaces. Their placement varies based on the element that opens them.\n *\n *  <div class=\"screenshots\">\n *   <img class=\"medium\" src=\"screenshots/menu-1.png\" />\n *   <img class=\"medium\" src=\"screenshots/menu-2.png\" />\n * </div>\n *\n * ## Usage\n * ```js\n * import * as React from 'react';\n * import { View } from 'react-native';\n * import { Button, Paragraph, Menu, Divider, Provider } from 'react-native-paper';\n *\n * export default class MyComponent extends React.Component {\n *   state = {\n *     visible: false,\n *   };\n *\n *   _openMenu = () => this.setState({ visible: true });\n *\n *   _closeMenu = () => this.setState({ visible: false });\n *\n *   render() {\n *     return (\n *       <Provider>\n *         <View\n *           style={{\n *             paddingTop: 50,\n *             flexDirection: 'row',\n *             justifyContent: 'center'\n *           }}>\n *           <Menu\n *             visible={this.state.visible}\n *             onDismiss={this._closeMenu}\n *             anchor={\n *               <Button onPress={this._openMenu}>Show menu</Button>\n *             }\n *           >\n *             <Menu.Item onPress={() => {}} title=\"Item 1\" />\n *             <Menu.Item onPress={() => {}} title=\"Item 2\" />\n *             <Divider />\n *             <Menu.Item onPress={() => {}} title=\"Item 3\" />\n *           </Menu>\n *         </View>\n *       </Provider>\n *     );\n *   }\n * }\n * ```\n */\nclass Menu extends React.Component<Props, State> {\n  // @component ./MenuItem.js\n  static Item = MenuItem;\n\n  state = {\n    top: 0,\n    left: 0,\n    menuLayout: { width: 0, height: 0 },\n    anchorLayout: { width: 0, height: 0 },\n    opacityAnimation: new Animated.Value(0),\n    scaleAnimation: new Animated.ValueXY({ x: 0, y: 0 }),\n  };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.visible !== this.props.visible) {\n      this._updateVisibility();\n    }\n  }\n\n  componentWillUnmount() {\n    BackHandler.removeEventListener('hardwareBackPress', this.props.onDismiss);\n  }\n\n  _anchor: ?View;\n  _menu: ?View;\n\n  _measureMenuLayout = () =>\n    new Promise(resolve => {\n      if (this._menu) {\n        this._menu.measureInWindow((x, y, width, height) => {\n          resolve({ x, y, width, height });\n        });\n      }\n    });\n\n  _measureAnchorLayout = () =>\n    new Promise(resolve => {\n      if (this._anchor) {\n        this._anchor.measureInWindow((x, y, width, height) => {\n          resolve({ x, y, width, height });\n        });\n      }\n    });\n\n  _updateVisibility = () => {\n    if (this.props.visible) {\n      this._show();\n    } else {\n      this._hide();\n    }\n  };\n\n  _show = async () => {\n    BackHandler.addEventListener('hardwareBackPress', this.props.onDismiss);\n\n    const [menuLayout, anchorLayout] = await Promise.all([\n      this._measureMenuLayout(),\n      this._measureAnchorLayout(),\n    ]);\n\n    // When visible is true for first render\n    // native views can be still not rendered and\n    // measureMenuLayout/measureAnchorLayout functions\n    // return wrong values e.g { x:0, y: 0, width: 0, height: 0 }\n    // so we have to wait until views are ready\n    // and rerun this function to show menu\n    if (\n      !menuLayout.width ||\n      !menuLayout.height ||\n      !anchorLayout.width ||\n      !anchorLayout.height\n    ) {\n      BackHandler.removeEventListener(\n        'hardwareBackPress',\n        this.props.onDismiss\n      );\n      setTimeout(() => {\n        this._show();\n      }, ANIMATION_DURATION);\n      return;\n    }\n\n    this.setState(\n      {\n        left: anchorLayout.x,\n        top: anchorLayout.y,\n        anchorLayout: {\n          height: anchorLayout.height,\n          width: anchorLayout.width,\n        },\n        menuLayout: {\n          width: menuLayout.width,\n          height: menuLayout.height,\n        },\n      },\n      () => {\n        Animated.parallel([\n          Animated.timing(this.state.scaleAnimation, {\n            toValue: { x: menuLayout.width, y: menuLayout.height },\n            duration: ANIMATION_DURATION,\n            easing: EASING,\n            useNativeDriver: true,\n          }),\n          Animated.timing(this.state.opacityAnimation, {\n            toValue: 1,\n            duration: ANIMATION_DURATION,\n            easing: EASING,\n            useNativeDriver: true,\n          }),\n        ]).start();\n      }\n    );\n  };\n\n  _hide = () => {\n    BackHandler.removeEventListener('hardwareBackPress', this.props.onDismiss);\n\n    Animated.timing(this.state.opacityAnimation, {\n      toValue: 0,\n      duration: ANIMATION_DURATION,\n      easing: EASING,\n      useNativeDriver: true,\n    }).start(finished => {\n      if (finished) {\n        this.state.scaleAnimation.setValue({ x: 0, y: 0 });\n      }\n    });\n  };\n\n  render() {\n    const { visible, anchor, style, children, theme, onDismiss } = this.props;\n\n    const {\n      menuLayout,\n      anchorLayout,\n      opacityAnimation,\n      scaleAnimation,\n    } = this.state;\n\n    // I don't know why but on Android measure function is wrong by 24\n    const additionalVerticalValue = Platform.select({\n      android: 24,\n      default: 0,\n    });\n\n    let { left, top } = this.state;\n\n    const scaleTransforms = [\n      {\n        scaleX: scaleAnimation.x.interpolate({\n          inputRange: [0, menuLayout.width],\n          outputRange: [0, 1],\n        }),\n      },\n      {\n        scaleY: scaleAnimation.y.interpolate({\n          inputRange: [0, menuLayout.height],\n          outputRange: [0, 1],\n        }),\n      },\n    ];\n\n    // We need to translate menu while animating scale to imitate transform origin for scale animation\n    const positionTransforms = [];\n\n    const { width: screenWidth, height: screenHeight } = Dimensions.get(\n      'screen'\n    );\n\n    // Check if menu fits horizontally and if not align it to right.\n    if (left <= screenWidth - menuLayout.width - SCREEN_INDENT) {\n      positionTransforms.push({\n        translateX: scaleAnimation.x.interpolate({\n          inputRange: [0, menuLayout.width],\n          outputRange: [-(menuLayout.width / 2), 0],\n        }),\n      });\n\n      // Check if menu position has enough space from left side\n      if (left >= 0 && left < SCREEN_INDENT) {\n        left = SCREEN_INDENT;\n      }\n    } else {\n      positionTransforms.push({\n        translateX: scaleAnimation.x.interpolate({\n          inputRange: [0, menuLayout.width],\n          outputRange: [menuLayout.width / 2, 0],\n        }),\n      });\n\n      left += anchorLayout.width - menuLayout.width;\n\n      const right = left + menuLayout.width;\n      // Check if menu position has enough space from right side\n      if (right <= screenWidth && right > screenWidth - SCREEN_INDENT) {\n        left = screenWidth - SCREEN_INDENT - menuLayout.width;\n      }\n    }\n\n    // Check if menu fits vertically and if not align it to bottom.\n    if (top <= screenHeight - menuLayout.height - SCREEN_INDENT) {\n      positionTransforms.push({\n        translateY: scaleAnimation.y.interpolate({\n          inputRange: [0, menuLayout.height],\n          outputRange: [-(menuLayout.height / 2), 0],\n        }),\n      });\n\n      // Check if menu position has enough space from top side\n      if (top >= 0 && top < SCREEN_INDENT) {\n        top = SCREEN_INDENT;\n      }\n    } else {\n      positionTransforms.push({\n        translateY: scaleAnimation.y.interpolate({\n          inputRange: [0, menuLayout.height],\n          outputRange: [menuLayout.height / 2, 0],\n        }),\n      });\n\n      top += anchorLayout.height - menuLayout.height;\n\n      const bottom = top + menuLayout.height + additionalVerticalValue;\n      // Check if menu position has enough space from bottom side\n      if (bottom <= screenHeight && bottom > screenHeight - SCREEN_INDENT) {\n        top =\n          screenHeight -\n          SCREEN_INDENT -\n          menuLayout.height -\n          additionalVerticalValue;\n      }\n    }\n\n    const shadowMenuContainerStyle = {\n      opacity: opacityAnimation,\n      transform: scaleTransforms,\n      borderRadius: theme.roundness,\n    };\n\n    const positionStyle = {\n      top: top + additionalVerticalValue,\n      ...(I18nManager.isRTL ? { right: left } : { left }),\n    };\n\n    return (\n      <View\n        ref={ref => {\n          this._anchor = ref;\n        }}\n        collapsable={false}\n      >\n        {anchor}\n        <Portal>\n          {visible ? (\n            <TouchableWithoutFeedback onPress={onDismiss}>\n              <View style={StyleSheet.absoluteFill} />\n            </TouchableWithoutFeedback>\n          ) : null}\n          <View\n            ref={ref => {\n              // This hack is needed to properly show menu\n              // when visible is `true` initially\n              // because in componentDidMount _menu ref is undefined\n              // because it's rendered in portal\n              if (!this._menu) {\n                this._menu = ref;\n                if (visible) {\n                  this._show();\n                }\n              }\n            }}\n            collapsable={false}\n            pointerEvents={visible ? 'auto' : 'none'}\n            style={[styles.wrapper, positionStyle, style]}\n          >\n            <Animated.View style={{ transform: positionTransforms }}>\n              <Surface\n                style={[styles.shadowMenuContainer, shadowMenuContainerStyle]}\n              >\n                {children}\n              </Surface>\n            </Animated.View>\n          </View>\n        </Portal>\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  wrapper: {\n    position: 'absolute',\n  },\n  shadowMenuContainer: {\n    opacity: 0,\n    paddingVertical: 8,\n    elevation: 8,\n  },\n});\n\nexport default withTheme(Menu);\n"]}