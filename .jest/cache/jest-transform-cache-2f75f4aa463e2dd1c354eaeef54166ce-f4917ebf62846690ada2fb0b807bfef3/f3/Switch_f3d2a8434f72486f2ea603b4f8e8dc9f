8f049d3a4bc2cabfae30a8e35a421658
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var SwitchNativeComponent = require('SwitchNativeComponent');

var Platform = require('Platform');

var React = require('React');

var StyleSheet = require('StyleSheet');

var Switch = function (_React$Component) {
  (0, _inherits2.default)(Switch, _React$Component);

  function Switch() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2.default)(this, Switch);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(Switch)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_handleChange", function (event) {
      if (_this._nativeSwitchRef == null) {
        return;
      }

      var value = _this.props.value === true;

      if (Platform.OS === 'android') {
        _this._nativeSwitchRef.setNativeProps({
          on: value
        });
      } else {
        _this._nativeSwitchRef.setNativeProps({
          value: value
        });
      }

      if (_this.props.onChange != null) {
        _this.props.onChange(event);
      }

      if (_this.props.onValueChange != null) {
        _this.props.onValueChange(event.nativeEvent.value);
      }
    });
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_handleSwitchNativeComponentRef", function (ref) {
      _this._nativeSwitchRef = ref;
    });
    return _this;
  }

  (0, _createClass2.default)(Switch, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          disabled = _this$props.disabled,
          ios_backgroundColor = _this$props.ios_backgroundColor,
          onChange = _this$props.onChange,
          onValueChange = _this$props.onValueChange,
          style = _this$props.style,
          thumbColor = _this$props.thumbColor,
          trackColor = _this$props.trackColor,
          value = _this$props.value,
          props = (0, _objectWithoutProperties2.default)(_this$props, ["disabled", "ios_backgroundColor", "onChange", "onValueChange", "style", "thumbColor", "trackColor", "value"]);
      var _thumbColor = thumbColor;

      var _trackColorForFalse = trackColor == null ? void 0 : trackColor.false;

      var _trackColorForTrue = trackColor == null ? void 0 : trackColor.true;

      var _ref = props,
          thumbTintColor = _ref.thumbTintColor,
          tintColor = _ref.tintColor,
          onTintColor = _ref.onTintColor;

      if (thumbTintColor != null) {
        _thumbColor = thumbTintColor;

        if (__DEV__) {
          console.warn('Switch: `thumbTintColor` is deprecated, use `thumbColor` instead.');
        }
      }

      if (tintColor != null) {
        _trackColorForFalse = tintColor;

        if (__DEV__) {
          console.warn('Switch: `tintColor` is deprecated, use `trackColor` instead.');
        }
      }

      if (onTintColor != null) {
        _trackColorForTrue = onTintColor;

        if (__DEV__) {
          console.warn('Switch: `onTintColor` is deprecated, use `trackColor` instead.');
        }
      }

      var platformProps = Platform.OS === 'android' ? {
        enabled: disabled !== true,
        on: value === true,
        style: style,
        thumbTintColor: _thumbColor,
        trackTintColor: value === true ? _trackColorForTrue : _trackColorForFalse
      } : {
        disabled: disabled,
        onTintColor: _trackColorForTrue,
        style: StyleSheet.compose({
          height: 31,
          width: 51
        }, StyleSheet.compose(style, ios_backgroundColor == null ? null : {
          backgroundColor: ios_backgroundColor,
          borderRadius: 16
        })),
        thumbTintColor: _thumbColor,
        tintColor: _trackColorForFalse,
        value: value === true
      };
      return React.createElement(SwitchNativeComponent, (0, _extends2.default)({}, props, platformProps, {
        onChange: this._handleChange,
        onResponderTerminationRequest: returnsFalse,
        onStartShouldSetResponder: returnsTrue,
        ref: this._handleSwitchNativeComponentRef
      }));
    }
  }]);
  return Switch;
}(React.Component);

var returnsFalse = function returnsFalse() {
  return false;
};

var returnsTrue = function returnsTrue() {
  return true;
};

module.exports = Switch;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN3aXRjaC5qcyJdLCJuYW1lcyI6WyJTd2l0Y2hOYXRpdmVDb21wb25lbnQiLCJyZXF1aXJlIiwiUGxhdGZvcm0iLCJSZWFjdCIsIlN0eWxlU2hlZXQiLCJTd2l0Y2giLCJldmVudCIsIl9uYXRpdmVTd2l0Y2hSZWYiLCJ2YWx1ZSIsInByb3BzIiwiT1MiLCJzZXROYXRpdmVQcm9wcyIsIm9uIiwib25DaGFuZ2UiLCJvblZhbHVlQ2hhbmdlIiwibmF0aXZlRXZlbnQiLCJyZWYiLCJkaXNhYmxlZCIsImlvc19iYWNrZ3JvdW5kQ29sb3IiLCJzdHlsZSIsInRodW1iQ29sb3IiLCJ0cmFja0NvbG9yIiwiX3RodW1iQ29sb3IiLCJfdHJhY2tDb2xvckZvckZhbHNlIiwiZmFsc2UiLCJfdHJhY2tDb2xvckZvclRydWUiLCJ0cnVlIiwidGh1bWJUaW50Q29sb3IiLCJ0aW50Q29sb3IiLCJvblRpbnRDb2xvciIsIl9fREVWX18iLCJjb25zb2xlIiwid2FybiIsInBsYXRmb3JtUHJvcHMiLCJlbmFibGVkIiwidHJhY2tUaW50Q29sb3IiLCJjb21wb3NlIiwiaGVpZ2h0Iiwid2lkdGgiLCJiYWNrZ3JvdW5kQ29sb3IiLCJib3JkZXJSYWRpdXMiLCJfaGFuZGxlQ2hhbmdlIiwicmV0dXJuc0ZhbHNlIiwicmV0dXJuc1RydWUiLCJfaGFuZGxlU3dpdGNoTmF0aXZlQ29tcG9uZW50UmVmIiwiQ29tcG9uZW50IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBVUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSxxQkFBcUIsR0FBR0MsT0FBTyxDQUFDLHVCQUFELENBQXJDOztBQUNBLElBQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBQ0EsSUFBTUUsS0FBSyxHQUFHRixPQUFPLENBQUMsT0FBRCxDQUFyQjs7QUFDQSxJQUFNRyxVQUFVLEdBQUdILE9BQU8sQ0FBQyxZQUFELENBQTFCOztJQXFFTUksTTs7Ozs7Ozs7Ozs7Ozs7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QUFpQmlCLGtCQUFqQixHQUFzQ0Y7QUFOekMsT0FETCxHQVNLO0FBQ0NOLFFBQUFBLFFBQVEsRUFBUkEsUUFERDtBQUVDWSxRQUFBQSxXQUFXLEVBQUVKLGtCQUZkO0FBR0NOLFFBQUFBLEtBQUssRUFBRWYsVUFBVSxDQUFDZ0MsT0FBWCxDQUNMO0FBQUNDLFVBQUFBLE1BQU0sRUFBRSxFQUFUO0FBQWFDLFVBQUFBLEtBQUssRUFBRTtBQUFwQixTQURLLEVBRUxsQyxVQUFVLENBQUNnQyxPQUFYLENBQ0VqQixLQURGLEVBRUVELG1CQUFtQixJQUFJLElBQXZCLEdBQ0ksSUFESixHQUVJO0FBQ0VxQixVQUFBQSxlQUFlLEVBQUVyQixtQkFEbkI7QUFFRXNCLFVBQUFBLFlBQVksRUFBRTtBQUZoQixTQUpOLENBRkssQ0FIUjtBQWVDYixRQUFBQSxjQUFjLEVBQUVMLFdBZmpCO0FBZ0JDTSxRQUFBQSxTQUFTLEVBQUVMLG1CQWhCWjtBQWlCQ2YsUUFBQUEsS0FBSyxFQUFFQSxLQUFLLEtBQUs7QUFqQmxCLE9BVlA7QUE4QkEsYUFDRSxvQkFBQyxxQkFBRCw2QkFDTUMsS0FETixFQUVNd0IsYUFGTjtBQUdFLFFBQUEsUUFBUSxFQUFFLEtBQUtRLGFBSGpCO0FBSUUsUUFBQSw2QkFBNkIsRUFBRUMsWUFKakM7QUFLRSxRQUFBLHlCQUF5QixFQUFFQyxXQUw3QjtBQU1FLFFBQUEsR0FBRyxFQUFFLEtBQUtDO0FBTlosU0FERjtBQVVEOzs7RUF4RmtCekMsS0FBSyxDQUFDMEMsUzs7QUF1SDNCLElBQU1ILFlBQVksR0FBRyxTQUFmQSxZQUFlO0FBQUEsU0FBTSxLQUFOO0FBQUEsQ0FBckI7O0FBQ0EsSUFBTUMsV0FBVyxHQUFHLFNBQWRBLFdBQWM7QUFBQSxTQUFNLElBQU47QUFBQSxDQUFwQjs7QUFFQUcsTUFBTSxDQUFDQyxPQUFQLEdBQWlCMUMsTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxMy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBTd2l0Y2hOYXRpdmVDb21wb25lbnQgPSByZXF1aXJlKCdTd2l0Y2hOYXRpdmVDb21wb25lbnQnKTtcbmNvbnN0IFBsYXRmb3JtID0gcmVxdWlyZSgnUGxhdGZvcm0nKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgnUmVhY3QnKTtcbmNvbnN0IFN0eWxlU2hlZXQgPSByZXF1aXJlKCdTdHlsZVNoZWV0Jyk7XG5cbmltcG9ydCB0eXBlIHtTd2l0Y2hDaGFuZ2VFdmVudH0gZnJvbSAnQ29yZUV2ZW50VHlwZXMnO1xuaW1wb3J0IHR5cGUge0NvbG9yVmFsdWV9IGZyb20gJ1N0eWxlU2hlZXRUeXBlcyc7XG5pbXBvcnQgdHlwZSB7Vmlld1Byb3BzfSBmcm9tICdWaWV3UHJvcFR5cGVzJztcbmltcG9ydCB0eXBlIHtOYXRpdmVBbmRyb2lkUHJvcHMsIE5hdGl2ZUlPU1Byb3BzfSBmcm9tICdTd2l0Y2hOYXRpdmVDb21wb25lbnQnO1xuXG5leHBvcnQgdHlwZSBQcm9wcyA9ICRSZWFkT25seTx7fFxuICAuLi5WaWV3UHJvcHMsXG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIHN3aXRjaCBpcyBkaXNhYmxlZC4gRGVmYXVsdHMgdG8gZmFsc2UuXG4gICAqL1xuICBkaXNhYmxlZD86ID9ib29sZWFuLFxuXG4gIC8qKlxuICAgKiBCb29sZWFuIHZhbHVlIG9mIHRoZSBzd2l0Y2guIERlZmF1bHRzIHRvIGZhbHNlLlxuICAgKi9cbiAgdmFsdWU/OiA/Ym9vbGVhbixcblxuICAvKipcbiAgICogQ3VzdG9tIGNvbG9yIGZvciB0aGUgc3dpdGNoIHRodW1iLlxuICAgKi9cbiAgdGh1bWJDb2xvcj86ID9Db2xvclZhbHVlLFxuXG4gIC8qKlxuICAgKiBDdXN0b20gY29sb3JzIGZvciB0aGUgc3dpdGNoIHRyYWNrLlxuICAgKlxuICAgKiBOT1RFOiBPbiBpT1Mgd2hlbiB0aGUgc3dpdGNoIHZhbHVlIGlzIGZhbHNlLCB0aGUgdHJhY2sgc2hyaW5rcyBpbnRvIHRoZVxuICAgKiBib3JkZXIuIElmIHlvdSB3YW50IHRvIGNoYW5nZSB0aGUgY29sb3Igb2YgdGhlIGJhY2tncm91bmQgZXhwb3NlZCBieSB0aGVcbiAgICogc2hydW5rZW4gdHJhY2ssIHVzZSBgaW9zX2JhY2tncm91bmRDb2xvcmAuXG4gICAqL1xuICB0cmFja0NvbG9yPzogPyRSZWFkT25seTx7fFxuICAgIGZhbHNlPzogP0NvbG9yVmFsdWUsXG4gICAgdHJ1ZT86ID9Db2xvclZhbHVlLFxuICB8fT4sXG5cbiAgLyoqXG4gICAqIE9uIGlPUywgY3VzdG9tIGNvbG9yIGZvciB0aGUgYmFja2dyb3VuZC4gVGhpcyBiYWNrZ3JvdW5kIGNvbG9yIGNhbiBiZSBzZWVuXG4gICAqIGVpdGhlciB3aGVuIHRoZSBzd2l0Y2ggdmFsdWUgaXMgZmFsc2Ugb3Igd2hlbiB0aGUgc3dpdGNoIGlzIGRpc2FibGVkIChhbmRcbiAgICogdGhlIHN3aXRjaCBpcyB0cmFuc2x1Y2VudCkuXG4gICAqL1xuICBpb3NfYmFja2dyb3VuZENvbG9yPzogP0NvbG9yVmFsdWUsXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRoZSB1c2VyIHRyaWVzIHRvIGNoYW5nZSB0aGUgdmFsdWUgb2YgdGhlIHN3aXRjaC5cbiAgICpcbiAgICogUmVjZWl2ZXMgdGhlIGNoYW5nZSBldmVudCBhcyBhbiBhcmd1bWVudC4gSWYgeW91IHdhbnQgdG8gb25seSByZWNlaXZlIHRoZVxuICAgKiBuZXcgdmFsdWUsIHVzZSBgb25WYWx1ZUNoYW5nZWAgaW5zdGVhZC5cbiAgICovXG4gIG9uQ2hhbmdlPzogPyhldmVudDogU3dpdGNoQ2hhbmdlRXZlbnQpID0+IFByb21pc2U8dm9pZD4gfCB2b2lkLFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0aGUgdXNlciB0cmllcyB0byBjaGFuZ2UgdGhlIHZhbHVlIG9mIHRoZSBzd2l0Y2guXG4gICAqXG4gICAqIFJlY2VpdmVzIHRoZSBuZXcgdmFsdWUgYXMgYW4gYXJndW1lbnQuIElmIHlvdSB3YW50IHRvIGluc3RlYWQgcmVjZWl2ZSBhblxuICAgKiBldmVudCwgdXNlIGBvbkNoYW5nZWAuXG4gICAqL1xuICBvblZhbHVlQ2hhbmdlPzogPyh2YWx1ZTogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQsXG58fT47XG5cbi8qKlxuICogQSB2aXN1YWwgdG9nZ2xlIGJldHdlZW4gdHdvIG11dHVhbGx5IGV4Y2x1c2l2ZSBzdGF0ZXMuXG4gKlxuICogVGhpcyBpcyBhIGNvbnRyb2xsZWQgY29tcG9uZW50IHRoYXQgcmVxdWlyZXMgYW4gYG9uVmFsdWVDaGFuZ2VgIGNhbGxiYWNrIHRoYXRcbiAqIHVwZGF0ZXMgdGhlIGB2YWx1ZWAgcHJvcCBpbiBvcmRlciBmb3IgdGhlIGNvbXBvbmVudCB0byByZWZsZWN0IHVzZXIgYWN0aW9ucy5cbiAqIElmIHRoZSBgdmFsdWVgIHByb3AgaXMgbm90IHVwZGF0ZWQsIHRoZSBjb21wb25lbnQgd2lsbCBjb250aW51ZSB0byByZW5kZXIgdGhlXG4gKiBzdXBwbGllZCBgdmFsdWVgIHByb3AgaW5zdGVhZCBvZiB0aGUgZXhwZWN0ZWQgcmVzdWx0IG9mIGFueSB1c2VyIGFjdGlvbnMuXG4gKi9cbmNsYXNzIFN3aXRjaCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICBfbmF0aXZlU3dpdGNoUmVmOiA/UmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgU3dpdGNoTmF0aXZlQ29tcG9uZW50PjtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgZGlzYWJsZWQsXG4gICAgICBpb3NfYmFja2dyb3VuZENvbG9yLFxuICAgICAgb25DaGFuZ2UsXG4gICAgICBvblZhbHVlQ2hhbmdlLFxuICAgICAgc3R5bGUsXG4gICAgICB0aHVtYkNvbG9yLFxuICAgICAgdHJhY2tDb2xvcixcbiAgICAgIHZhbHVlLFxuICAgICAgLi4ucHJvcHNcbiAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgIC8vIFN1cHBvcnQgZGVwcmVjYXRlZCBjb2xvciBwcm9wcy5cbiAgICBsZXQgX3RodW1iQ29sb3IgPSB0aHVtYkNvbG9yO1xuICAgIGxldCBfdHJhY2tDb2xvckZvckZhbHNlID0gdHJhY2tDb2xvcj8uZmFsc2U7XG4gICAgbGV0IF90cmFja0NvbG9yRm9yVHJ1ZSA9IHRyYWNrQ29sb3I/LnRydWU7XG5cbiAgICAvLyBUT0RPOiBSZW1vdmUgc3VwcG9ydCBmb3IgdGhlc2UgcHJvcHMgYWZ0ZXIgYSBjb3VwbGUgcmVsZWFzZXMuXG4gICAgY29uc3Qge3RodW1iVGludENvbG9yLCB0aW50Q29sb3IsIG9uVGludENvbG9yfSA9IChwcm9wczogJEZsb3dGaXhNZSk7XG4gICAgaWYgKHRodW1iVGludENvbG9yICE9IG51bGwpIHtcbiAgICAgIF90aHVtYkNvbG9yID0gdGh1bWJUaW50Q29sb3I7XG4gICAgICBpZiAoX19ERVZfXykge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgJ1N3aXRjaDogYHRodW1iVGludENvbG9yYCBpcyBkZXByZWNhdGVkLCB1c2UgYHRodW1iQ29sb3JgIGluc3RlYWQuJyxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRpbnRDb2xvciAhPSBudWxsKSB7XG4gICAgICBfdHJhY2tDb2xvckZvckZhbHNlID0gdGludENvbG9yO1xuICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICdTd2l0Y2g6IGB0aW50Q29sb3JgIGlzIGRlcHJlY2F0ZWQsIHVzZSBgdHJhY2tDb2xvcmAgaW5zdGVhZC4nLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAob25UaW50Q29sb3IgIT0gbnVsbCkge1xuICAgICAgX3RyYWNrQ29sb3JGb3JUcnVlID0gb25UaW50Q29sb3I7XG4gICAgICBpZiAoX19ERVZfXykge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgJ1N3aXRjaDogYG9uVGludENvbG9yYCBpcyBkZXByZWNhdGVkLCB1c2UgYHRyYWNrQ29sb3JgIGluc3RlYWQuJyxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBwbGF0Zm9ybVByb3BzID1cbiAgICAgIFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCdcbiAgICAgICAgPyAoe1xuICAgICAgICAgICAgZW5hYmxlZDogZGlzYWJsZWQgIT09IHRydWUsXG4gICAgICAgICAgICBvbjogdmFsdWUgPT09IHRydWUsXG4gICAgICAgICAgICBzdHlsZSxcbiAgICAgICAgICAgIHRodW1iVGludENvbG9yOiBfdGh1bWJDb2xvcixcbiAgICAgICAgICAgIHRyYWNrVGludENvbG9yOlxuICAgICAgICAgICAgICB2YWx1ZSA9PT0gdHJ1ZSA/IF90cmFja0NvbG9yRm9yVHJ1ZSA6IF90cmFja0NvbG9yRm9yRmFsc2UsXG4gICAgICAgICAgfTogTmF0aXZlQW5kcm9pZFByb3BzKVxuICAgICAgICA6ICh7XG4gICAgICAgICAgICBkaXNhYmxlZCxcbiAgICAgICAgICAgIG9uVGludENvbG9yOiBfdHJhY2tDb2xvckZvclRydWUsXG4gICAgICAgICAgICBzdHlsZTogU3R5bGVTaGVldC5jb21wb3NlKFxuICAgICAgICAgICAgICB7aGVpZ2h0OiAzMSwgd2lkdGg6IDUxfSxcbiAgICAgICAgICAgICAgU3R5bGVTaGVldC5jb21wb3NlKFxuICAgICAgICAgICAgICAgIHN0eWxlLFxuICAgICAgICAgICAgICAgIGlvc19iYWNrZ3JvdW5kQ29sb3IgPT0gbnVsbFxuICAgICAgICAgICAgICAgICAgPyBudWxsXG4gICAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGlvc19iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAxNixcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB0aHVtYlRpbnRDb2xvcjogX3RodW1iQ29sb3IsXG4gICAgICAgICAgICB0aW50Q29sb3I6IF90cmFja0NvbG9yRm9yRmFsc2UsXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUgPT09IHRydWUsXG4gICAgICAgICAgfTogTmF0aXZlSU9TUHJvcHMpO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxTd2l0Y2hOYXRpdmVDb21wb25lbnRcbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgICB7Li4ucGxhdGZvcm1Qcm9wc31cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMuX2hhbmRsZUNoYW5nZX1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q9e3JldHVybnNGYWxzZX1cbiAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17cmV0dXJuc1RydWV9XG4gICAgICAgIHJlZj17dGhpcy5faGFuZGxlU3dpdGNoTmF0aXZlQ29tcG9uZW50UmVmfVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgX2hhbmRsZUNoYW5nZSA9IChldmVudDogU3dpdGNoQ2hhbmdlRXZlbnQpID0+IHtcbiAgICBpZiAodGhpcy5fbmF0aXZlU3dpdGNoUmVmID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBGb3JjZSB2YWx1ZSBvZiBuYXRpdmUgc3dpdGNoIGluIG9yZGVyIHRvIGNvbnRyb2wgaXQuXG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLnByb3BzLnZhbHVlID09PSB0cnVlO1xuICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnKSB7XG4gICAgICB0aGlzLl9uYXRpdmVTd2l0Y2hSZWYuc2V0TmF0aXZlUHJvcHMoe29uOiB2YWx1ZX0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9uYXRpdmVTd2l0Y2hSZWYuc2V0TmF0aXZlUHJvcHMoe3ZhbHVlfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucHJvcHMub25DaGFuZ2UgIT0gbnVsbCkge1xuICAgICAgdGhpcy5wcm9wcy5vbkNoYW5nZShldmVudCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucHJvcHMub25WYWx1ZUNoYW5nZSAhPSBudWxsKSB7XG4gICAgICB0aGlzLnByb3BzLm9uVmFsdWVDaGFuZ2UoZXZlbnQubmF0aXZlRXZlbnQudmFsdWUpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlU3dpdGNoTmF0aXZlQ29tcG9uZW50UmVmID0gKFxuICAgIHJlZjogP1JlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFN3aXRjaE5hdGl2ZUNvbXBvbmVudD4sXG4gICkgPT4ge1xuICAgIHRoaXMuX25hdGl2ZVN3aXRjaFJlZiA9IHJlZjtcbiAgfTtcbn1cblxuY29uc3QgcmV0dXJuc0ZhbHNlID0gKCkgPT4gZmFsc2U7XG5jb25zdCByZXR1cm5zVHJ1ZSA9ICgpID0+IHRydWU7XG5cbm1vZHVsZS5leHBvcnRzID0gU3dpdGNoO1xuIl19