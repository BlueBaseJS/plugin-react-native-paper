64e03bd0c98b1cf00f1dafcf50280347
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _Surface = _interopRequireDefault(require("./Surface"));

var _Text = _interopRequireDefault(require("./Typography/Text"));

var _Button = _interopRequireDefault(require("./Button"));

var _theming = require("../core/theming");

var _shadow = _interopRequireDefault(require("../styles/shadow"));

var ELEVATION = 1;

var Banner = function (_React$Component) {
  (0, _inherits2.default)(Banner, _React$Component);

  function Banner() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2.default)(this, Banner);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(Banner)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "state", {
      position: new _reactNative.Animated.Value(_this.props.visible ? 1 : 0),
      layout: {
        height: 0,
        measured: false
      }
    });
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_handleLayout", function (_ref) {
      var nativeEvent = _ref.nativeEvent;
      var height = nativeEvent.layout.height;

      _this.setState({
        layout: {
          height: height,
          measured: true
        }
      });
    });
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_toggle", function () {
      if (_this.props.visible) {
        _this._show();
      } else {
        _this._hide();
      }
    });
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_show", function () {
      _reactNative.Animated.timing(_this.state.position, {
        duration: 250,
        toValue: 1
      }).start();
    });
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "_hide", function () {
      _reactNative.Animated.timing(_this.state.position, {
        duration: 200,
        toValue: 0
      }).start();
    });
    return _this;
  }

  (0, _createClass2.default)(Banner, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      if (prevProps.visible !== this.props.visible) {
        this._toggle();
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props = this.props,
          visible = _this$props.visible,
          image = _this$props.image,
          children = _this$props.children,
          actions = _this$props.actions,
          style = _this$props.style,
          theme = _this$props.theme,
          rest = (0, _objectWithoutProperties2.default)(_this$props, ["visible", "image", "children", "actions", "style", "theme"]);
      var _this$state = this.state,
          position = _this$state.position,
          layout = _this$state.layout;

      var height = _reactNative.Animated.multiply(position, layout.height);

      var translateY = _reactNative.Animated.multiply(_reactNative.Animated.add(position, -1), layout.height);

      return React.createElement(_Surface.default, (0, _extends2.default)({}, rest, {
        style: [styles.container, (0, _shadow.default)(ELEVATION), style]
      }), React.createElement(_reactNative.View, {
        style: styles.wrapper
      }, React.createElement(_reactNative.Animated.View, {
        style: {
          height: height
        }
      }), React.createElement(_reactNative.Animated.View, {
        onLayout: this._handleLayout,
        style: [layout.measured || !visible ? [styles.absolute, {
          transform: [{
            translateY: translateY
          }]
        }] : null, !layout.measured && !visible ? {
          opacity: 0
        } : null]
      }, React.createElement(_reactNative.View, {
        style: styles.content
      }, image ? React.createElement(_reactNative.View, {
        style: styles.image
      }, image({
        size: 40
      })) : null, React.createElement(_Text.default, {
        style: styles.message
      }, children)), React.createElement(_reactNative.View, {
        style: styles.actions
      }, actions.map(function (_ref2, i) {
        var label = _ref2.label,
            others = (0, _objectWithoutProperties2.default)(_ref2, ["label"]);
        return React.createElement(_Button.default, (0, _extends2.default)({
          key: i,
          compact: true,
          mode: "text",
          style: styles.button
        }, others), label);
      })))));
    }
  }]);
  return Banner;
}(React.Component);

var styles = _reactNative.StyleSheet.create({
  container: {
    elevation: ELEVATION
  },
  wrapper: {
    overflow: 'hidden'
  },
  absolute: {
    position: 'absolute',
    top: 0,
    width: '100%'
  },
  content: {
    flexDirection: 'row',
    justifyContent: 'flex-start',
    marginHorizontal: 8,
    marginTop: 16,
    marginBottom: 0
  },
  image: {
    margin: 8
  },
  message: {
    flex: 1,
    margin: 8
  },
  actions: {
    flexDirection: 'row',
    justifyContent: 'flex-end',
    margin: 4
  },
  button: {
    margin: 4
  }
});

var _default = (0, _theming.withTheme)(Banner);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJhbm5lci5qcyJdLCJuYW1lcyI6WyJFTEVWQVRJT04iLCJCYW5uZXIiLCJwb3NpdGlvbiIsIkFuaW1hdGVkIiwiVmFsdWUiLCJwcm9wcyIsInZpc2libGUiLCJsYXlvdXQiLCJoZWlnaHQiLCJtZWFzdXJlZCIsIm5hdGl2ZUV2ZW50Iiwic2V0U3RhdGUiLCJfc2hvdyIsIl9oaWRlIiwidGltaW5nIiwic3RhdGUiLCJkdXJhdGlvbiIsInRvVmFsdWUiLCJzdGFydCIsInByZXZQcm9wcyIsIl90b2dnbGUiLCJpbWFnZSIsImNoaWxkcmVuIiwiYWN0aW9ucyIsInN0eWxlIiwidGhlbWUiLCJyZXN0IiwibXVsdGlwbHkiLCJ0cmFuc2xhdGVZIiwiYWRkIiwic3R5bGVzIiwiY29udGFpbmVyIiwid3JhcHBlciIsIl9oYW5kbGVMYXlvdXQiLCJhYnNvbHV0ZSIsInRyYW5zZm9ybSIsIm9wYWNpdHkiLCJjb250ZW50Iiwic2l6ZSIsIm1lc3NhZ2UiLCJtYXAiLCJpIiwibGFiZWwiLCJvdGhlcnMiLCJidXR0b24iLCJSZWFjdCIsIkNvbXBvbmVudCIsIlN0eWxlU2hlZXQiLCJjcmVhdGUiLCJlbGV2YXRpb24iLCJvdmVyZmxvdyIsInRvcCIsIndpZHRoIiwiZmxleERpcmVjdGlvbiIsImp1c3RpZnlDb250ZW50IiwibWFyZ2luSG9yaXpvbnRhbCIsIm1hcmdpblRvcCIsIm1hcmdpbkJvdHRvbSIsIm1hcmdpbiIsImZsZXgiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUVBLElBQU1BLFNBQVMsR0FBRyxDQUFsQjs7SUF1R01DLE07Ozs7Ozs7Ozs7Ozs7Ozt3RkFDSTtBQUNOQyxNQUFBQSxRQUFRLEVBQUUsSUFBSUMsc0JBQVNDLEtBQWIsQ0FBbUIsTUFBS0MsS0FBTCxDQUFXQyxPQUFYLEdBQXFCLENBQXJCLEdBQXlCLENBQTVDLENBREo7QUFFTkMsTUFBQUEs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L0JoQixFQUFBQSxRQUFRLEVBQUU7QUFDUmhDLElBQUFBLFFBQVEsRUFBRSxVQURGO0FBRVJpRCxJQUFBQSxHQUFHLEVBQUUsQ0FGRztBQUdSQyxJQUFBQSxLQUFLLEVBQUU7QUFIQyxHQVBxQjtBQVkvQmYsRUFBQUEsT0FBTyxFQUFFO0FBQ1BnQixJQUFBQSxhQUFhLEVBQUUsS0FEUjtBQUVQQyxJQUFBQSxjQUFjLEVBQUUsWUFGVDtBQUdQQyxJQUFBQSxnQkFBZ0IsRUFBRSxDQUhYO0FBSVBDLElBQUFBLFNBQVMsRUFBRSxFQUpKO0FBS1BDLElBQUFBLFlBQVksRUFBRTtBQUxQLEdBWnNCO0FBbUIvQnBDLEVBQUFBLEtBQUssRUFBRTtBQUNMcUMsSUFBQUEsTUFBTSxFQUFFO0FBREgsR0FuQndCO0FBc0IvQm5CLEVBQUFBLE9BQU8sRUFBRTtBQUNQb0IsSUFBQUEsSUFBSSxFQUFFLENBREM7QUFFUEQsSUFBQUEsTUFBTSxFQUFFO0FBRkQsR0F0QnNCO0FBMEIvQm5DLEVBQUFBLE9BQU8sRUFBRTtBQUNQOEIsSUFBQUEsYUFBYSxFQUFFLEtBRFI7QUFFUEMsSUFBQUEsY0FBYyxFQUFFLFVBRlQ7QUFHUEksSUFBQUEsTUFBTSxFQUFFO0FBSEQsR0ExQnNCO0FBK0IvQmQsRUFBQUEsTUFBTSxFQUFFO0FBQ05jLElBQUFBLE1BQU0sRUFBRTtBQURGO0FBL0J1QixDQUFsQixDQUFmOztlQW9DZSx3QkFBVXpELE1BQVYsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFZpZXcsIFN0eWxlU2hlZXQsIEFuaW1hdGVkIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBTdXJmYWNlIGZyb20gJy4vU3VyZmFjZSc7XG5pbXBvcnQgVGV4dCBmcm9tICcuL1R5cG9ncmFwaHkvVGV4dCc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJy4vQnV0dG9uJztcbmltcG9ydCB7IHdpdGhUaGVtZSB9IGZyb20gJy4uL2NvcmUvdGhlbWluZyc7XG5pbXBvcnQgdHlwZSB7IFRoZW1lLCAkUmVtb3ZlQ2hpbGRyZW4gfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgc2hhZG93IGZyb20gJy4uL3N0eWxlcy9zaGFkb3cnO1xuXG5jb25zdCBFTEVWQVRJT04gPSAxO1xuXG50eXBlIFByb3BzID0gJFJlbW92ZUNoaWxkcmVuPHR5cGVvZiBTdXJmYWNlPiAmIHt8XG4gIC8qKlxuICAgKiBXaGV0aGVyIGJhbm5lciBpcyBjdXJyZW50bHkgdmlzaWJsZS5cbiAgICovXG4gIHZpc2libGU6IGJvb2xlYW4sXG4gIC8qKlxuICAgKiBDb250ZW50IHRoYXQgd2lsbCBiZSBkaXNwbGF5ZWQgaW5zaWRlIGJhbm5lci5cbiAgICovXG4gIGNoaWxkcmVuOiBzdHJpbmcsXG4gIC8qKlxuICAgKiBDYWxsYmFjayB0aGF0IHJldHVybnMgYW4gaW1hZ2UgdG8gZGlzcGxheSBpbnNpZGUgYmFubmVyLlxuICAgKi9cbiAgaW1hZ2U/OiAocHJvcHM6IHsgc2l6ZTogbnVtYmVyIH0pID0+IFJlYWN0Lk5vZGUsXG4gIC8qKlxuICAgKiBBY3Rpb24gaXRlbXMgdG8gc2hvd24gaW4gdGhlIGJhbm5lci5cbiAgICogQW4gYWN0aW9uIGl0ZW0gc2hvdWxkIGNvbnRhaW4gdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICAgKlxuICAgKiAtIGBsYWJlbGA6IGxhYmVsIG9mIHRoZSBhY3Rpb24gYnV0dG9uIChyZXF1aXJlZClcbiAgICogLSBgb25QcmVzc2A6IGNhbGxiYWNrIHRoYXQgaXMgY2FsbGVkIHdoZW4gYnV0dG9uIGlzIHByZXNzZWQgKHJlcXVpcmVkKVxuICAgKlxuICAgKiBUbyBjdXN0b21pemUgYnV0dG9uIHlvdSBjYW4gcGFzcyBvdGhlciBwcm9wcyB0aGF0IGJ1dHRvbiBjb21wb25lbnQgdGFrZXMuXG4gICAqL1xuICBhY3Rpb25zOiBBcnJheTx7XG4gICAgbGFiZWw6IHN0cmluZyxcbiAgICBvblByZXNzOiAoKSA9PiBtaXhlZCxcbiAgfT4sXG4gIHN0eWxlPzogYW55LFxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqL1xuICB0aGVtZTogVGhlbWUsXG58fTtcblxudHlwZSBTdGF0ZSA9IHtcbiAgcG9zaXRpb246IEFuaW1hdGVkLlZhbHVlLFxuICBsYXlvdXQ6IHtcbiAgICBoZWlnaHQ6IG51bWJlcixcbiAgICBtZWFzdXJlZDogYm9vbGVhbixcbiAgfSxcbn07XG5cbnR5cGUgTmF0aXZlRXZlbnQgPSB7XG4gIG5hdGl2ZUV2ZW50OiB7XG4gICAgbGF5b3V0OiB7XG4gICAgICB4OiBudW1iZXIsXG4gICAgICB5OiBudW1iZXIsXG4gICAgICB3aWR0aDogbnVtYmVyLFxuICAgICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgfSxcbiAgfSxcbn07XG5cbi8qKlxuICogQmFubmVyIGRpc3BsYXlzIGEgcHJvbWluZW50IG1lc3NhZ2UgYW5kIHJlbGF0ZWQgYWN0aW9ucy5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwic2NyZWVuc2hvdHNcIj5cbiAqICAgPGltZyBjbGFzcz1cIm1lZGl1bVwiIHNyYz1cInNjcmVlbnNob3RzL2Jhbm5lci5naWZcIiAvPlxuICogPC9kaXY+XG4gKlxuICogIyMgVXNhZ2VcbiAqIGBgYGpzXG4gKiBpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG4gKiBpbXBvcnQgeyBJbWFnZSB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG4gKiBpbXBvcnQgeyBCYW5uZXIgfSBmcm9tICdyZWFjdC1uYXRpdmUtcGFwZXInO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAqICAgc3RhdGUgPSB7XG4gKiAgICAgdmlzaWJsZTogdHJ1ZSxcbiAqICAgfTtcbiAqXG4gKiAgIHJlbmRlcigpIHtcbiAqICAgICByZXR1cm4gKFxuICogICAgICAgPEJhbm5lclxuICogICAgICAgICB2aXNpYmxlPXt0aGlzLnN0YXRlLnZpc2libGV9XG4gKiAgICAgICAgIGFjdGlvbnM9e1tcbiAqICAgICAgICAgICB7XG4gKiAgICAgICAgICAgICBsYWJlbDogJ0ZpeCBpdCcsXG4gKiAgICAgICAgICAgICBvblByZXNzOiAoKSA9PiB0aGlzLnNldFN0YXRlKHsgdmlzaWJsZTogZmFsc2UgfSksXG4gKiAgICAgICAgICAgfSxcbiAqICAgICAgICAgICB7XG4gKiAgICAgICAgICAgICBsYWJlbDogJ0xlYXJuIG1vcmUnLFxuICogICAgICAgICAgICAgb25QcmVzczogKCkgPT4gdGhpcy5zZXRTdGF0ZSh7IHZpc2libGU6IGZhbHNlIH0pLFxuICogICAgICAgICAgIH0sXG4gKiAgICAgICAgIF19XG4gKiAgICAgICAgIGltYWdlPXsoeyBzaXplIH0pID0+XG4gKiAgICAgICAgICAgPEltYWdlXG4gKiAgICAgICAgICAgICBzb3VyY2U9e3sgdXJpOiAnaHR0cHM6Ly9hdmF0YXJzMy5naXRodWJ1c2VyY29udGVudC5jb20vdS8xNzU3MTk2OT9zPTQwMCZ2PTQnIH19XG4gKiAgICAgICAgICAgICBzdHlsZT17e1xuICogICAgICAgICAgICAgICB3aWR0aDogc2l6ZSxcbiAqICAgICAgICAgICAgICAgaGVpZ2h0OiBzaXplLFxuICogICAgICAgICAgICAgfX1cbiAqICAgICAgICAgICAvPlxuICogICAgICAgICB9XG4gKiAgICAgICA+XG4gKiAgICAgICAgIFRoZXJlIHdhcyBhIHByb2JsZW0gcHJvY2Vzc2luZyBhIHRyYW5zYWN0aW9uIG9uIHlvdXIgY3JlZGl0IGNhcmQuXG4gKiAgICAgICA8L0Jhbm5lcj5cbiAqICAgICApO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuY2xhc3MgQmFubmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICBzdGF0ZSA9IHtcbiAgICBwb3NpdGlvbjogbmV3IEFuaW1hdGVkLlZhbHVlKHRoaXMucHJvcHMudmlzaWJsZSA/IDEgOiAwKSxcbiAgICBsYXlvdXQ6IHtcbiAgICAgIGhlaWdodDogMCxcbiAgICAgIG1lYXN1cmVkOiBmYWxzZSxcbiAgICB9LFxuICB9O1xuXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMpIHtcbiAgICBpZiAocHJldlByb3BzLnZpc2libGUgIT09IHRoaXMucHJvcHMudmlzaWJsZSkge1xuICAgICAgdGhpcy5fdG9nZ2xlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZUxheW91dCA9ICh7IG5hdGl2ZUV2ZW50IH06IE5hdGl2ZUV2ZW50KSA9PiB7XG4gICAgY29uc3QgeyBoZWlnaHQgfSA9IG5hdGl2ZUV2ZW50LmxheW91dDtcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBsYXlvdXQ6IHsgaGVpZ2h0LCBtZWFzdXJlZDogdHJ1ZSB9IH0pO1xuICB9O1xuXG4gIF90b2dnbGUgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMudmlzaWJsZSkge1xuICAgICAgdGhpcy5fc2hvdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlKCk7XG4gICAgfVxuICB9O1xuXG4gIF9zaG93ID0gKCkgPT4ge1xuICAgIEFuaW1hdGVkLnRpbWluZyh0aGlzLnN0YXRlLnBvc2l0aW9uLCB7XG4gICAgICBkdXJhdGlvbjogMjUwLFxuICAgICAgdG9WYWx1ZTogMSxcbiAgICB9KS5zdGFydCgpO1xuICB9O1xuXG4gIF9oaWRlID0gKCkgPT4ge1xuICAgIEFuaW1hdGVkLnRpbWluZyh0aGlzLnN0YXRlLnBvc2l0aW9uLCB7XG4gICAgICBkdXJhdGlvbjogMjAwLFxuICAgICAgdG9WYWx1ZTogMCxcbiAgICB9KS5zdGFydCgpO1xuICB9O1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7XG4gICAgICB2aXNpYmxlLFxuICAgICAgaW1hZ2UsXG4gICAgICBjaGlsZHJlbixcbiAgICAgIGFjdGlvbnMsXG4gICAgICBzdHlsZSxcbiAgICAgIHRoZW1lLFxuICAgICAgLi4ucmVzdFxuICAgIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgcG9zaXRpb24sIGxheW91dCB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIC8vIFRoZSBiYW5uZXIgYW5pbWF0aW9uIGhhcyAyIHBhcnRzOlxuICAgIC8vIDEuIEJsYW5rIHNwYWNlciBlbGVtZW50IHdoaWNoIGFuaW1hdGVzIGl0cyBoZWlnaHQgdG8gbW92ZSB0aGUgY29udGVudFxuICAgIC8vIDIuIEFjdHVhbCBiYW5uZXIgd2hpY2ggYW5pbWF0ZXMgaXRzIHRyYW5zbGF0ZVlcbiAgICAvLyBJbiBpbml0aWFsIHJlbmRlciwgd2UgcG9zaXRpb24gZXZlcnl0aGluZyBub3JtYWxseSBhbmQgbWVhc3VyZSB0aGUgaGVpZ2h0IG9mIHRoZSBiYW5uZXJcbiAgICAvLyBPbmNlIHdlIGhhdmUgdGhlIGhlaWdodCwgd2UgYXBwbHkgdGhlIGhlaWdodCB0byB0aGUgc3BhY2VyIGFuZCBzd2l0Y2ggdGhlIGJhbm5lciB0byBwb3NpdGlvbjogYWJzb2x1dGVcbiAgICAvLyBXZSBuZWVkIHRoaXMgYmVjYXVzZSB3ZSBuZWVkIHRvIG1vdmUgdGhlIGNvbnRlbnQgYmVsb3cgYXMgaWYgYmFubmVyJ3MgaGVpZ2h0IHdhcyBiZWluZyBhbmltYXRlZFxuICAgIC8vIEhvd2V2ZXIgd2UgY2FuJ3QgYW5pbWF0ZWQgYmFubmVyJ3MgaGVpZ2h0IGRpcmVjdGx5IGFzIGl0J2xsIGFsc28gcmVzaXplIHRoZSBjb250ZW50IGluc2lkZVxuICAgIGNvbnN0IGhlaWdodCA9IEFuaW1hdGVkLm11bHRpcGx5KHBvc2l0aW9uLCBsYXlvdXQuaGVpZ2h0KTtcblxuICAgIGNvbnN0IHRyYW5zbGF0ZVkgPSBBbmltYXRlZC5tdWx0aXBseShcbiAgICAgIEFuaW1hdGVkLmFkZChwb3NpdGlvbiwgLTEpLFxuICAgICAgbGF5b3V0LmhlaWdodFxuICAgICk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFN1cmZhY2Ugey4uLnJlc3R9IHN0eWxlPXtbc3R5bGVzLmNvbnRhaW5lciwgc2hhZG93KEVMRVZBVElPTiksIHN0eWxlXX0+XG4gICAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMud3JhcHBlcn0+XG4gICAgICAgICAgPEFuaW1hdGVkLlZpZXcgc3R5bGU9e3sgaGVpZ2h0IH19IC8+XG4gICAgICAgICAgPEFuaW1hdGVkLlZpZXdcbiAgICAgICAgICAgIG9uTGF5b3V0PXt0aGlzLl9oYW5kbGVMYXlvdXR9XG4gICAgICAgICAgICBzdHlsZT17W1xuICAgICAgICAgICAgICBsYXlvdXQubWVhc3VyZWQgfHwgIXZpc2libGVcbiAgICAgICAgICAgICAgICA/IC8vIElmIHdlIGhhdmUgbWVhc3VyZWQgYmFubmVyJ3MgaGVpZ2h0IG9yIGl0J3MgaW52aXNpYmxlLFxuICAgICAgICAgICAgICAgICAgLy8gUG9zaXRpb24gaXQgYWJzb2x1dGVseSwgdGhlIGxheW91dCB3aWxsIGJlIHRha2VuIGNhcmUgb2YgdGhlIHNwYWNlclxuICAgICAgICAgICAgICAgICAgW3N0eWxlcy5hYnNvbHV0ZSwgeyB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVkgfV0gfV1cbiAgICAgICAgICAgICAgICA6IC8vIE90aGVyd2lzZSBwb3NpdGlvbiBpdCBub3JtYWxseVxuICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgIWxheW91dC5tZWFzdXJlZCAmJiAhdmlzaWJsZVxuICAgICAgICAgICAgICAgID8gLy8gSWYgd2UgaGF2ZW4ndCBtZWFzdXJlZCBiYW5uZXIncyBoZWlnaHQgeWV0IGFuZCBpdCdzIGludmlzaWJsZSxcbiAgICAgICAgICAgICAgICAgIC8vIGhpZGUgaXQgd2l0aCBvcGFjaXR5OiAwIHNvIHVzZXIgZG9lc24ndCBzZWUgaXRcbiAgICAgICAgICAgICAgICAgIHsgb3BhY2l0eTogMCB9XG4gICAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAgICAgXX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8VmlldyBzdHlsZT17c3R5bGVzLmNvbnRlbnR9PlxuICAgICAgICAgICAgICB7aW1hZ2UgPyAoXG4gICAgICAgICAgICAgICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5pbWFnZX0+e2ltYWdlKHsgc2l6ZTogNDAgfSl9PC9WaWV3PlxuICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgPFRleHQgc3R5bGU9e3N0eWxlcy5tZXNzYWdlfT57Y2hpbGRyZW59PC9UZXh0PlxuICAgICAgICAgICAgPC9WaWV3PlxuICAgICAgICAgICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5hY3Rpb25zfT5cbiAgICAgICAgICAgICAge2FjdGlvbnMubWFwKCh7IGxhYmVsLCAuLi5vdGhlcnMgfSwgaSkgPT4gKFxuICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgIGtleT17LyogZXNsaW50LWRpc2FibGUtbGluZSByZWFjdC9uby1hcnJheS1pbmRleC1rZXkgKi8gaX1cbiAgICAgICAgICAgICAgICAgIGNvbXBhY3RcbiAgICAgICAgICAgICAgICAgIG1vZGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtzdHlsZXMuYnV0dG9ufVxuICAgICAgICAgICAgICAgICAgey4uLm90aGVyc31cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7bGFiZWx9XG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgPC9WaWV3PlxuICAgICAgICAgIDwvQW5pbWF0ZWQuVmlldz5cbiAgICAgICAgPC9WaWV3PlxuICAgICAgPC9TdXJmYWNlPlxuICAgICk7XG4gIH1cbn1cblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICBjb250YWluZXI6IHtcbiAgICBlbGV2YXRpb246IEVMRVZBVElPTixcbiAgfSxcbiAgd3JhcHBlcjoge1xuICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgfSxcbiAgYWJzb2x1dGU6IHtcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICB0b3A6IDAsXG4gICAgd2lkdGg6ICcxMDAlJyxcbiAgfSxcbiAgY29udGVudDoge1xuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICAgIGp1c3RpZnlDb250ZW50OiAnZmxleC1zdGFydCcsXG4gICAgbWFyZ2luSG9yaXpvbnRhbDogOCxcbiAgICBtYXJnaW5Ub3A6IDE2LFxuICAgIG1hcmdpbkJvdHRvbTogMCxcbiAgfSxcbiAgaW1hZ2U6IHtcbiAgICBtYXJnaW46IDgsXG4gIH0sXG4gIG1lc3NhZ2U6IHtcbiAgICBmbGV4OiAxLFxuICAgIG1hcmdpbjogOCxcbiAgfSxcbiAgYWN0aW9uczoge1xuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICAgIGp1c3RpZnlDb250ZW50OiAnZmxleC1lbmQnLFxuICAgIG1hcmdpbjogNCxcbiAgfSxcbiAgYnV0dG9uOiB7XG4gICAgbWFyZ2luOiA0LFxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhUaGVtZShCYW5uZXIpO1xuIl19