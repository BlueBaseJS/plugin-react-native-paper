{"version":3,"sources":["toIterator.js"],"names":["KIND_KEY","KIND_VALUE","KIND_KEY_VAL","ITERATOR_SYMBOL","Symbol","iterator","toIterator","Array","prototype","String","ArrayIterator","array","kind","isArray","TypeError","_iteratedObject","_kind","_nextIndex","createIterResultObject","undefined","len","length","index","StringIterator","string","_iteratedString","s","ret","first","charCodeAt","second","value","done","object","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n */\n\n'use strict';\n\n/**\n * Given an object `toIterator` will return the itrator for that object. If the\n * object has a `Symbol.iterator` method we just call that. Otherwise we\n * implement the ES6 `Array` and `String` Iterator.\n */\n\n/**\n * Constants\n */\n\nconst KIND_KEY = 'key';\nconst KIND_VALUE = 'value';\nconst KIND_KEY_VAL = 'key+value';\n/*global Symbol: true*/\nconst ITERATOR_SYMBOL =\n  typeof Symbol === 'function' ? Symbol.iterator : '@@iterator';\n\nconst toIterator = (function() {\n  if (\n    !(Array.prototype[ITERATOR_SYMBOL] && String.prototype[ITERATOR_SYMBOL])\n  ) {\n    // IIFE to avoid creating classes for no reason because of hoisting.\n    return (function() {\n      class ArrayIterator {\n        // 22.1.5.1 CreateArrayIterator Abstract Operation\n        constructor(array, kind) {\n          if (!Array.isArray(array)) {\n            throw new TypeError('Object is not an Array');\n          }\n          this._iteratedObject = array;\n          this._kind = kind;\n          this._nextIndex = 0;\n        }\n\n        // 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n        next() {\n          if (!this instanceof ArrayIterator) {\n            throw new TypeError('Object is not an ArrayIterator');\n          }\n\n          if (this._iteratedObject == null) {\n            return createIterResultObject(undefined, true);\n          }\n\n          const array = this._iteratedObject;\n          const len = this._iteratedObject.length;\n          const index = this._nextIndex;\n          const kind = this._kind;\n\n          if (index >= len) {\n            this._iteratedObject = undefined;\n            return createIterResultObject(undefined, true);\n          }\n\n          this._nextIndex = index + 1;\n\n          if (kind === KIND_KEY) {\n            return createIterResultObject(index, false);\n          } else if (kind === KIND_VALUE) {\n            return createIterResultObject(array[index], false);\n          } else if (kind === KIND_KEY_VAL) {\n            return createIterResultObject([index, array[index]], false);\n          }\n        }\n\n        // 22.1.5.2.2 %ArrayIteratorPrototype%[@@iterator]()\n        '@@iterator'() {\n          return this;\n        }\n      }\n\n      class StringIterator {\n        // 21.1.5.1 CreateStringIterator Abstract Operation\n        constructor(string) {\n          if (typeof string !== 'string') {\n            throw new TypeError('Object is not a string');\n          }\n          this._iteratedString = string;\n          this._nextIndex = 0;\n        }\n\n        // 21.1.5.2.1 %StringIteratorPrototype%.next()\n        next() {\n          if (!this instanceof StringIterator) {\n            throw new TypeError('Object is not a StringIterator');\n          }\n\n          if (this._iteratedString == null) {\n            return createIterResultObject(undefined, true);\n          }\n\n          const index = this._nextIndex;\n          const s = this._iteratedString;\n          const len = s.length;\n\n          if (index >= len) {\n            this._iteratedString = undefined;\n            return createIterResultObject(undefined, true);\n          }\n\n          let ret;\n          const first = s.charCodeAt(index);\n\n          if (first < 0xd800 || first > 0xdbff || index + 1 === len) {\n            ret = s[index];\n          } else {\n            const second = s.charCodeAt(index + 1);\n            if (second < 0xdc00 || second > 0xdfff) {\n              ret = s[index];\n            } else {\n              ret = s[index] + s[index + 1];\n            }\n          }\n\n          this._nextIndex = index + ret.length;\n\n          return createIterResultObject(ret, false);\n        }\n\n        // 21.1.5.2.2 %StringIteratorPrototype%[@@ITERATOR_SYMBOL]()\n        '@@iterator'() {\n          return this;\n        }\n      }\n\n      // 7.4.7 createIterResultObject(value, done)\n      function createIterResultObject(value, done) {\n        return {value: value, done: done};\n      }\n\n      return function(object, kind) {\n        if (typeof object === 'string') {\n          return new StringIterator(object);\n        } else if (Array.isArray(object)) {\n          return new ArrayIterator(object, kind || KIND_VALUE);\n        } else {\n          return object[ITERATOR_SYMBOL]();\n        }\n      };\n    })();\n  } else {\n    return function(object) {\n      return object[ITERATOR_SYMBOL]();\n    };\n  }\n})();\n\n/**\n * Export constants\n */\n\nObject.assign(toIterator, {\n  KIND_KEY,\n  KIND_VALUE,\n  KIND_KEY_VAL,\n  ITERATOR_SYMBOL,\n});\n\nmodule.exports = toIterator;\n"]}