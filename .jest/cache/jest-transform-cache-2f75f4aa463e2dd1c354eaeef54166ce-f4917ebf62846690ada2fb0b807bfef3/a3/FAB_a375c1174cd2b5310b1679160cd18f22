06b3dacbaba8a4188e8997d886bf1b8d
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _color = _interopRequireDefault(require("color"));

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _FABGroup = _interopRequireDefault(require("./FABGroup"));

var _Surface = _interopRequireDefault(require("../Surface"));

var _CrossFadeIcon = _interopRequireDefault(require("../CrossFadeIcon"));

var _Text = _interopRequireDefault(require("../Typography/Text"));

var _TouchableRipple = _interopRequireDefault(require("../TouchableRipple"));

var _colors = require("../../styles/colors");

var _theming = require("../../core/theming");

var FAB = function (_React$Component) {
  (0, _inherits2.default)(FAB, _React$Component);

  function FAB() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2.default)(this, FAB);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(FAB)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), "state", {
      visibility: new _reactNative.Animated.Value(_this.props.visible ? 1 : 0)
    });
    return _this;
  }

  (0, _createClass2.default)(FAB, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      if (this.props.visible === prevProps.visible) {
        return;
      }

      if (this.props.visible) {
        _reactNative.Animated.timing(this.state.visibility, {
          toValue: 1,
          duration: 200,
          useNativeDriver: true
        }).start();
      } else {
        _reactNative.Animated.timing(this.state.visibility, {
          toValue: 0,
          duration: 150,
          useNativeDriver: true
        }).start();
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props = this.props,
          small = _this$props.small,
          icon = _this$props.icon,
          label = _this$props.label,
          _this$props$accessibi = _this$props.accessibilityLabel,
          accessibilityLabel = _this$props$accessibi === void 0 ? label : _this$props$accessibi,
          customColor = _this$props.color,
          disabled = _this$props.disabled,
          onPress = _this$props.onPress,
          theme = _this$props.theme,
          style = _this$props.style,
          visible = _this$props.visible,
          rest = (0, _objectWithoutProperties2.default)(_this$props, ["small", "icon", "label", "accessibilityLabel", "color", "disabled", "onPress", "theme", "style", "visible"]);
      var visibility = this.state.visibility;
      var disabledColor = (0, _color.default)(theme.dark ? _colors.white : _colors.black).alpha(0.12).rgb().string();

      var _ref = _reactNative.StyleSheet.flatten(style) || {},
          _ref$backgroundColor = _ref.backgroundColor,
          backgroundColor = _ref$backgroundColor === void 0 ? disabled ? disabledColor : theme.colors.accent : _ref$backgroundColor;

      var foregroundColor;

      if (typeof customColor !== 'undefined') {
        foregroundColor = customColor;
      } else if (disabled) {
        foregroundColor = (0, _color.default)(theme.dark ? _colors.white : _colors.black).alpha(0.32).rgb().string();
      } else {
        foregroundColor = !(0, _color.default)(backgroundColor).light() ? _colors.white : 'rgba(0, 0, 0, .54)';
      }

      var rippleColor = (0, _color.default)(foregroundColor).alpha(0.32).rgb().string();
      return React.createElement(_Surface.default, (0, _extends2.default)({}, rest, {
        style: [{
          backgroundColor: backgroundColor,
          opacity: visibility,
          transform: [{
            scale: visibility
          }]
        }, styles.container, disabled && styles.disabled, style],
        pointerEvents: visible ? 'auto' : 'none'
      }), React.createElement(_TouchableRipple.default, {
        borderless: true,
        onPress: onPress,
        rippleColor: rippleColor,
        disabled: disabled,
        accessibilityLabel: accessibilityLabel,
        accessibilityTraits: disabled ? ['button', 'disabled'] : 'button',
        accessibilityComponentType: "button",
        accessibilityRole: "button",
        accessibilityStates: disabled ? ['disabled'] : undefined,
        style: styles.touchable
      }, React.createElement(_reactNative.View, {
        style: [styles.content, label ? styles.extended : small ? styles.small : styles.standard],
        pointerEvents: "none"
      }, React.createElement(_CrossFadeIcon.default, {
        source: icon,
        size: 24,
        color: foregroundColor
      }), label ? React.createElement(_Text.default, {
        style: [styles.label, {
          color: foregroundColor,
          fontFamily: theme.fonts.medium
        }]
      }, label.toUpperCase()) : null)));
    }
  }]);
  return FAB;
}(React.Component);

(0, _defineProperty2.default)(FAB, "Group", _FABGroup.default);
(0, _defineProperty2.default)(FAB, "defaultProps", {
  visible: true
});

var styles = _reactNative.StyleSheet.create({
  container: {
    borderRadius: 28,
    elevation: 6
  },
  touchable: {
    borderRadius: 28
  },
  standard: {
    height: 56,
    width: 56
  },
  small: {
    height: 40,
    width: 40
  },
  extended: {
    height: 48,
    paddingHorizontal: 16
  },
  content: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center'
  },
  label: {
    marginHorizontal: 8
  },
  disabled: {
    elevation: 0
  }
});

var _default = (0, _theming.withTheme)(FAB);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZBQi5qcyJdLCJuYW1lcyI6WyJGQUIiLCJ2aXNpYmlsaXR5IiwiQW5pbWF0ZWQiLCJWYWx1ZSIsInByb3BzIiwidmlzaWJsZSIsInByZXZQcm9wcyIsInRpbWluZyIsInN0YXRlIiwidG9WYWx1ZSIsImR1cmF0aW9uIiwidXNlTmF0aXZlRHJpdmVyIiwic3RhcnQiLCJzbWFsbCIsImljb24iLCJsYWJlbCIsImFjY2Vzc2liaWxpdHlMYWJlbCIsImN1c3RvbUNvbG9yIiwiY29sb3IiLCJkaXNhYmxlZCIsIm9uUHJlc3MiLCJ0aGVtZSIsInN0eWxlIiwicmVzdCIsImRpc2FibGVkQ29sb3IiLCJkYXJrIiwid2hpdGUiLCJibGFjayIsImFscGhhIiwicmdiIiwic3RyaW5nIiwiU3R5bGVTaGVldCIsImZsYXR0ZW4iLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb2xvcnMiLCJhY2NlbnQiLCJmb3JlZ3JvdW5kQ29sb3IiLCJsaWdodCIsInJpcHBsZUNvbG9yIiwib3BhY2l0eSIsInRyYW5zZm9ybSIsInNjYWxlIiwic3R5bGVzIiwiY29udGFpbmVyIiwidW5kZWZpbmVkIiwidG91Y2hhYmxlIiwiY29udGVudCIsImV4dGVuZGVkIiwic3RhbmRhcmQiLCJmb250RmFtaWx5IiwiZm9udHMiLCJtZWRpdW0iLCJ0b1VwcGVyQ2FzZSIsIlJlYWN0IiwiQ29tcG9uZW50IiwiRkFCR3JvdXAiLCJjcmVhdGUiLCJib3JkZXJSYWRpdXMiLCJlbGV2YXRpb24iLCJoZWlnaHQiLCJ3aWR0aCIsInBhZGRpbmdIb3Jpem9udGFsIiwiZmxleERpcmVjdGlvbiIsImFsaWduSXRlbXMiLCJqdXN0aWZ5Q29udGVudCIsIm1hcmdpbkhvcml6b250YWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztJQW9GTUEsRzs7Ozs7Ozs7Ozs7Ozs7O3dGQVFJO0FBQ05D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RUFBRTtBQUNSdUMsSUFBQUEsU0FBUyxFQUFFO0FBREg7QUE1QnFCLENBQWxCLENBQWY7O2VBaUNlLHdCQUFVMUQsR0FBVixDIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cblxuaW1wb3J0IGNvbG9yIGZyb20gJ2NvbG9yJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEFuaW1hdGVkLCBWaWV3LCBTdHlsZVNoZWV0IH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBGQUJHcm91cCBmcm9tICcuL0ZBQkdyb3VwJztcbmltcG9ydCBTdXJmYWNlIGZyb20gJy4uL1N1cmZhY2UnO1xuaW1wb3J0IENyb3NzRmFkZUljb24gZnJvbSAnLi4vQ3Jvc3NGYWRlSWNvbic7XG5pbXBvcnQgVGV4dCBmcm9tICcuLi9UeXBvZ3JhcGh5L1RleHQnO1xuaW1wb3J0IFRvdWNoYWJsZVJpcHBsZSBmcm9tICcuLi9Ub3VjaGFibGVSaXBwbGUnO1xuaW1wb3J0IHsgYmxhY2ssIHdoaXRlIH0gZnJvbSAnLi4vLi4vc3R5bGVzL2NvbG9ycyc7XG5pbXBvcnQgeyB3aXRoVGhlbWUgfSBmcm9tICcuLi8uLi9jb3JlL3RoZW1pbmcnO1xuaW1wb3J0IHR5cGUgeyBUaGVtZSwgJFJlbW92ZUNoaWxkcmVuIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBJY29uU291cmNlIH0gZnJvbSAnLi8uLi9JY29uJztcblxudHlwZSBQcm9wcyA9ICRSZW1vdmVDaGlsZHJlbjx0eXBlb2YgU3VyZmFjZT4gJiB7fFxuICAvKipcbiAgICogSWNvbiB0byBkaXNwbGF5IGZvciB0aGUgYEZBQmAuXG4gICAqL1xuICBpY29uOiBJY29uU291cmNlLFxuICAvKipcbiAgICogT3B0aW9uYWwgbGFiZWwgZm9yIGV4dGVuZGVkIGBGQUJgLlxuICAgKi9cbiAgbGFiZWw/OiBzdHJpbmcsXG4gIC8qKlxuICAgKiBBY2Nlc3NpYmlsaXR5IGxhYmVsIGZvciB0aGUgRkFCLiBUaGlzIGlzIHJlYWQgYnkgdGhlIHNjcmVlbiByZWFkZXIgd2hlbiB0aGUgdXNlciB0YXBzIHRoZSBGQUIuXG4gICAqIFVzZXMgYGxhYmVsYCBieSBkZWZhdWx0IGlmIHNwZWNpZmllZC5cbiAgICovXG4gIGFjY2Vzc2liaWxpdHlMYWJlbD86IHN0cmluZyxcbiAgLyoqXG4gICAqICBXaGV0aGVyIEZBQiBpcyBtaW5pLXNpemVkLCB1c2VkIHRvIGNyZWF0ZSB2aXN1YWwgY29udGludWl0eSB3aXRoIG90aGVyIGVsZW1lbnRzLiBUaGlzIGhhcyBubyBlZmZlY3QgaWYgYGxhYmVsYCBpcyBzcGVjaWZpZWQuXG4gICAqL1xuICBzbWFsbD86IGJvb2xlYW4sXG4gIC8qKlxuICAgKiBDdXN0b20gY29sb3IgZm9yIHRoZSBgRkFCYC5cbiAgICovXG4gIGNvbG9yPzogc3RyaW5nLFxuICAvKipcbiAgICogV2hldGhlciBgRkFCYCBpcyBkaXNhYmxlZC4gQSBkaXNhYmxlZCBidXR0b24gaXMgZ3JleWVkIG91dCBhbmQgYG9uUHJlc3NgIGlzIG5vdCBjYWxsZWQgb24gdG91Y2guXG4gICAqL1xuICBkaXNhYmxlZD86IGJvb2xlYW4sXG4gIC8qKlxuICAgKiBXaGV0aGVyIGBGQUJgIGlzIGN1cnJlbnRseSB2aXNpYmxlLlxuICAgKi9cbiAgdmlzaWJsZTogYm9vbGVhbixcbiAgLyoqXG4gICAqIEZ1bmN0aW9uIHRvIGV4ZWN1dGUgb24gcHJlc3MuXG4gICAqL1xuICBvblByZXNzPzogKCkgPT4gbWl4ZWQsXG4gIHN0eWxlPzogYW55LFxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqL1xuICB0aGVtZTogVGhlbWUsXG58fTtcblxudHlwZSBTdGF0ZSA9IHtcbiAgdmlzaWJpbGl0eTogQW5pbWF0ZWQuVmFsdWUsXG59O1xuXG4vKipcbiAqIEEgZmxvYXRpbmcgYWN0aW9uIGJ1dHRvbiByZXByZXNlbnRzIHRoZSBwcmltYXJ5IGFjdGlvbiBpbiBhbiBhcHBsaWNhdGlvbi5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwic2NyZWVuc2hvdHNcIj5cbiAqICAgPGltZyBzcmM9XCJzY3JlZW5zaG90cy9mYWItMS5wbmdcIiAvPlxuICogICA8aW1nIHNyYz1cInNjcmVlbnNob3RzL2ZhYi0yLnBuZ1wiIC8+XG4gKiA8L2Rpdj5cbiAqXG4gKiAjIyBVc2FnZVxuICogYGBganNcbiAqIGltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbiAqIGltcG9ydCB7IFN0eWxlU2hlZXQgfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuICogaW1wb3J0IHsgRkFCIH0gZnJvbSAncmVhY3QtbmF0aXZlLXBhcGVyJztcbiAqXG4gKiBjb25zdCBNeUNvbXBvbmVudCA9ICgpID0+IChcbiAqICAgPEZBQlxuICogICAgIHN0eWxlPXtzdHlsZXMuZmFifVxuICogICAgIHNtYWxsXG4gKiAgICAgaWNvbj1cImFkZFwiXG4gKiAgICAgb25QcmVzcz17KCkgPT4gY29uc29sZS5sb2coJ1ByZXNzZWQnKX1cbiAqICAgLz5cbiAqICk7XG4gKlxuICogY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICogICBmYWI6IHtcbiAqICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAqICAgICBtYXJnaW46IDE2LFxuICogICAgIHJpZ2h0OiAwLFxuICogICAgIGJvdHRvbTogMCxcbiAqICAgfSxcbiAqIH0pXG4gKlxuICogZXhwb3J0IGRlZmF1bHQgTXlDb21wb25lbnQ7XG4gKiBgYGBcbiAqL1xuY2xhc3MgRkFCIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICAvLyBAY29tcG9uZW50IC4vRkFCR3JvdXAuanNcbiAgc3RhdGljIEdyb3VwID0gRkFCR3JvdXA7XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICB2aXNpYmxlOiB0cnVlLFxuICB9O1xuXG4gIHN0YXRlID0ge1xuICAgIHZpc2liaWxpdHk6IG5ldyBBbmltYXRlZC5WYWx1ZSh0aGlzLnByb3BzLnZpc2libGUgPyAxIDogMCksXG4gIH07XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgIGlmICh0aGlzLnByb3BzLnZpc2libGUgPT09IHByZXZQcm9wcy52aXNpYmxlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucHJvcHMudmlzaWJsZSkge1xuICAgICAgQW5pbWF0ZWQudGltaW5nKHRoaXMuc3RhdGUudmlzaWJpbGl0eSwge1xuICAgICAgICB0b1ZhbHVlOiAxLFxuICAgICAgICBkdXJhdGlvbjogMjAwLFxuICAgICAgICB1c2VOYXRpdmVEcml2ZXI6IHRydWUsXG4gICAgICB9KS5zdGFydCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBBbmltYXRlZC50aW1pbmcodGhpcy5zdGF0ZS52aXNpYmlsaXR5LCB7XG4gICAgICAgIHRvVmFsdWU6IDAsXG4gICAgICAgIGR1cmF0aW9uOiAxNTAsXG4gICAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICAgIH0pLnN0YXJ0KCk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHNtYWxsLFxuICAgICAgaWNvbixcbiAgICAgIGxhYmVsLFxuICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsID0gbGFiZWwsXG4gICAgICBjb2xvcjogY3VzdG9tQ29sb3IsXG4gICAgICBkaXNhYmxlZCxcbiAgICAgIG9uUHJlc3MsXG4gICAgICB0aGVtZSxcbiAgICAgIHN0eWxlLFxuICAgICAgdmlzaWJsZSxcbiAgICAgIC4uLnJlc3RcbiAgICB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IHZpc2liaWxpdHkgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICBjb25zdCBkaXNhYmxlZENvbG9yID0gY29sb3IodGhlbWUuZGFyayA/IHdoaXRlIDogYmxhY2spXG4gICAgICAuYWxwaGEoMC4xMilcbiAgICAgIC5yZ2IoKVxuICAgICAgLnN0cmluZygpO1xuXG4gICAgY29uc3QgeyBiYWNrZ3JvdW5kQ29sb3IgPSBkaXNhYmxlZCA/IGRpc2FibGVkQ29sb3IgOiB0aGVtZS5jb2xvcnMuYWNjZW50IH0gPVxuICAgICAgU3R5bGVTaGVldC5mbGF0dGVuKHN0eWxlKSB8fCB7fTtcblxuICAgIGxldCBmb3JlZ3JvdW5kQ29sb3I7XG5cbiAgICBpZiAodHlwZW9mIGN1c3RvbUNvbG9yICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgZm9yZWdyb3VuZENvbG9yID0gY3VzdG9tQ29sb3I7XG4gICAgfSBlbHNlIGlmIChkaXNhYmxlZCkge1xuICAgICAgZm9yZWdyb3VuZENvbG9yID0gY29sb3IodGhlbWUuZGFyayA/IHdoaXRlIDogYmxhY2spXG4gICAgICAgIC5hbHBoYSgwLjMyKVxuICAgICAgICAucmdiKClcbiAgICAgICAgLnN0cmluZygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3JlZ3JvdW5kQ29sb3IgPSAhY29sb3IoYmFja2dyb3VuZENvbG9yKS5saWdodCgpXG4gICAgICAgID8gd2hpdGVcbiAgICAgICAgOiAncmdiYSgwLCAwLCAwLCAuNTQpJztcbiAgICB9XG5cbiAgICBjb25zdCByaXBwbGVDb2xvciA9IGNvbG9yKGZvcmVncm91bmRDb2xvcilcbiAgICAgIC5hbHBoYSgwLjMyKVxuICAgICAgLnJnYigpXG4gICAgICAuc3RyaW5nKCk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFN1cmZhY2VcbiAgICAgICAgey4uLnJlc3R9XG4gICAgICAgIHN0eWxlPXtbXG4gICAgICAgICAge1xuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgb3BhY2l0eTogdmlzaWJpbGl0eSxcbiAgICAgICAgICAgIHRyYW5zZm9ybTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc2NhbGU6IHZpc2liaWxpdHksXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3R5bGVzLmNvbnRhaW5lcixcbiAgICAgICAgICBkaXNhYmxlZCAmJiBzdHlsZXMuZGlzYWJsZWQsXG4gICAgICAgICAgc3R5bGUsXG4gICAgICAgIF19XG4gICAgICAgIHBvaW50ZXJFdmVudHM9e3Zpc2libGUgPyAnYXV0bycgOiAnbm9uZSd9XG4gICAgICA+XG4gICAgICAgIDxUb3VjaGFibGVSaXBwbGVcbiAgICAgICAgICBib3JkZXJsZXNzXG4gICAgICAgICAgb25QcmVzcz17b25QcmVzc31cbiAgICAgICAgICByaXBwbGVDb2xvcj17cmlwcGxlQ29sb3J9XG4gICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbD17YWNjZXNzaWJpbGl0eUxhYmVsfVxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlUcmFpdHM9e2Rpc2FibGVkID8gWydidXR0b24nLCAnZGlzYWJsZWQnXSA6ICdidXR0b24nfVxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlDb21wb25lbnRUeXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICBhY2Nlc3NpYmlsaXR5Um9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgYWNjZXNzaWJpbGl0eVN0YXRlcz17ZGlzYWJsZWQgPyBbJ2Rpc2FibGVkJ10gOiB1bmRlZmluZWR9XG4gICAgICAgICAgc3R5bGU9e3N0eWxlcy50b3VjaGFibGV9XG4gICAgICAgID5cbiAgICAgICAgICA8Vmlld1xuICAgICAgICAgICAgc3R5bGU9e1tcbiAgICAgICAgICAgICAgc3R5bGVzLmNvbnRlbnQsXG4gICAgICAgICAgICAgIGxhYmVsID8gc3R5bGVzLmV4dGVuZGVkIDogc21hbGwgPyBzdHlsZXMuc21hbGwgOiBzdHlsZXMuc3RhbmRhcmQsXG4gICAgICAgICAgICBdfVxuICAgICAgICAgICAgcG9pbnRlckV2ZW50cz1cIm5vbmVcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxDcm9zc0ZhZGVJY29uIHNvdXJjZT17aWNvbn0gc2l6ZT17MjR9IGNvbG9yPXtmb3JlZ3JvdW5kQ29sb3J9IC8+XG4gICAgICAgICAgICB7bGFiZWwgPyAoXG4gICAgICAgICAgICAgIDxUZXh0XG4gICAgICAgICAgICAgICAgc3R5bGU9e1tcbiAgICAgICAgICAgICAgICAgIHN0eWxlcy5sYWJlbCxcbiAgICAgICAgICAgICAgICAgIHsgY29sb3I6IGZvcmVncm91bmRDb2xvciwgZm9udEZhbWlseTogdGhlbWUuZm9udHMubWVkaXVtIH0sXG4gICAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtsYWJlbC50b1VwcGVyQ2FzZSgpfVxuICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgIDwvVG91Y2hhYmxlUmlwcGxlPlxuICAgICAgPC9TdXJmYWNlPlxuICAgICk7XG4gIH1cbn1cblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICBjb250YWluZXI6IHtcbiAgICBib3JkZXJSYWRpdXM6IDI4LFxuICAgIGVsZXZhdGlvbjogNixcbiAgfSxcbiAgdG91Y2hhYmxlOiB7XG4gICAgYm9yZGVyUmFkaXVzOiAyOCxcbiAgfSxcbiAgc3RhbmRhcmQ6IHtcbiAgICBoZWlnaHQ6IDU2LFxuICAgIHdpZHRoOiA1NixcbiAgfSxcbiAgc21hbGw6IHtcbiAgICBoZWlnaHQ6IDQwLFxuICAgIHdpZHRoOiA0MCxcbiAgfSxcbiAgZXh0ZW5kZWQ6IHtcbiAgICBoZWlnaHQ6IDQ4LFxuICAgIHBhZGRpbmdIb3Jpem9udGFsOiAxNixcbiAgfSxcbiAgY29udGVudDoge1xuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgfSxcbiAgbGFiZWw6IHtcbiAgICBtYXJnaW5Ib3Jpem9udGFsOiA4LFxuICB9LFxuICBkaXNhYmxlZDoge1xuICAgIGVsZXZhdGlvbjogMCxcbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoVGhlbWUoRkFCKTtcbiJdfQ==